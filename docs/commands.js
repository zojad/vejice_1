/*! For license information please see commands.js.LICENSE.txt */
!function(){"use strict";var e={d:function(u,t){for(var n in t)e.o(t,n)&&!e.o(u,n)&&Object.defineProperty(u,n,{enumerable:!0,get:t[n]})},o:function(e,u){return Object.prototype.hasOwnProperty.call(e,u)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},u={};function t(e,u){return function(){return e.apply(u,arguments)}}e.r(u),e.d(u,{hasBrowserEnv:function(){return le},hasStandardBrowserEnv:function(){return de},hasStandardBrowserWebWorkerEnv:function(){return Fe},navigator:function(){return fe},origin:function(){return he}});const{toString:n}=Object.prototype,{getPrototypeOf:r}=Object,o=(a=Object.create(null),e=>{const u=n.call(e);return a[u]||(a[u]=u.slice(8,-1).toLowerCase())});var a;const i=e=>(e=e.toLowerCase(),u=>o(u)===e),s=e=>u=>typeof u===e,{isArray:c}=Array,D=s("undefined"),l=i("ArrayBuffer"),f=s("string"),d=s("function"),F=s("number"),h=e=>null!==e&&"object"==typeof e,p=e=>{if("object"!==o(e))return!1;const u=r(e);return!(null!==u&&u!==Object.prototype&&null!==Object.getPrototypeOf(u)||Symbol.toStringTag in e||Symbol.iterator in e)},E=i("Date"),A=i("File"),C=i("Blob"),g=i("FileList"),v=i("URLSearchParams"),[m,y,B,b]=["ReadableStream","Request","Response","Headers"].map(i);function w(e,u,{allOwnKeys:t=!1}={}){if(null==e)return;let n,r;if("object"!=typeof e&&(e=[e]),c(e))for(n=0,r=e.length;n<r;n++)u.call(null,e[n],n,e);else{const r=t?Object.getOwnPropertyNames(e):Object.keys(e),o=r.length;let a;for(n=0;n<o;n++)a=r[n],u.call(null,e[a],a,e)}}function k(e,u){u=u.toLowerCase();const t=Object.keys(e);let n,r=t.length;for(;r-- >0;)if(n=t[r],u===n.toLowerCase())return n;return null}const x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,T=e=>!D(e)&&e!==x,O=(S="undefined"!=typeof Uint8Array&&r(Uint8Array),e=>S&&e instanceof S);var S;const _=i("HTMLFormElement"),R=(({hasOwnProperty:e})=>(u,t)=>e.call(u,t))(Object.prototype),j=i("RegExp"),P=(e,u)=>{const t=Object.getOwnPropertyDescriptors(e),n={};w(t,(t,r)=>{let o;!1!==(o=u(t,r,e))&&(n[r]=o||t)}),Object.defineProperties(e,n)},I="abcdefghijklmnopqrstuvwxyz",N="0123456789",L={DIGIT:N,ALPHA:I,ALPHA_DIGIT:I+I.toUpperCase()+N},U=i("AsyncFunction"),W=(M="function"==typeof setImmediate,z=d(x.postMessage),M?setImmediate:z?(q=`axios@${Math.random()}`,V=[],x.addEventListener("message",({source:e,data:u})=>{e===x&&u===q&&V.length&&V.shift()()},!1),e=>{V.push(e),x.postMessage(q,"*")}):e=>setTimeout(e));var M,z,q,V;const K="undefined"!=typeof queueMicrotask?queueMicrotask.bind(x):"undefined"!=typeof process&&process.nextTick||W;var G={isArray:c,isArrayBuffer:l,isBuffer:function(e){return null!==e&&!D(e)&&null!==e.constructor&&!D(e.constructor)&&d(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let u;return e&&("function"==typeof FormData&&e instanceof FormData||d(e.append)&&("formdata"===(u=o(e))||"object"===u&&d(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let u;return u="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&l(e.buffer),u},isString:f,isNumber:F,isBoolean:e=>!0===e||!1===e,isObject:h,isPlainObject:p,isReadableStream:m,isRequest:y,isResponse:B,isHeaders:b,isUndefined:D,isDate:E,isFile:A,isBlob:C,isRegExp:j,isFunction:d,isStream:e=>h(e)&&d(e.pipe),isURLSearchParams:v,isTypedArray:O,isFileList:g,forEach:w,merge:function e(){const{caseless:u}=T(this)&&this||{},t={},n=(n,r)=>{const o=u&&k(t,r)||r;p(t[o])&&p(n)?t[o]=e(t[o],n):p(n)?t[o]=e({},n):c(n)?t[o]=n.slice():t[o]=n};for(let e=0,u=arguments.length;e<u;e++)arguments[e]&&w(arguments[e],n);return t},extend:(e,u,n,{allOwnKeys:r}={})=>(w(u,(u,r)=>{n&&d(u)?e[r]=t(u,n):e[r]=u},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,u,t,n)=>{e.prototype=Object.create(u.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:u.prototype}),t&&Object.assign(e.prototype,t)},toFlatObject:(e,u,t,n)=>{let o,a,i;const s={};if(u=u||{},null==e)return u;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)i=o[a],n&&!n(i,e,u)||s[i]||(u[i]=e[i],s[i]=!0);e=!1!==t&&r(e)}while(e&&(!t||t(e,u))&&e!==Object.prototype);return u},kindOf:o,kindOfTest:i,endsWith:(e,u,t)=>{e=String(e),(void 0===t||t>e.length)&&(t=e.length),t-=u.length;const n=e.indexOf(u,t);return-1!==n&&n===t},toArray:e=>{if(!e)return null;if(c(e))return e;let u=e.length;if(!F(u))return null;const t=new Array(u);for(;u-- >0;)t[u]=e[u];return t},forEachEntry:(e,u)=>{const t=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=t.next())&&!n.done;){const t=n.value;u.call(e,t[0],t[1])}},matchAll:(e,u)=>{let t;const n=[];for(;null!==(t=e.exec(u));)n.push(t);return n},isHTMLForm:_,hasOwnProperty:R,hasOwnProp:R,reduceDescriptors:P,freezeMethods:e=>{P(e,(u,t)=>{if(d(e)&&-1!==["arguments","caller","callee"].indexOf(t))return!1;const n=e[t];d(n)&&(u.enumerable=!1,"writable"in u?u.writable=!1:u.set||(u.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")}))})},toObjectSet:(e,u)=>{const t={},n=e=>{e.forEach(e=>{t[e]=!0})};return c(e)?n(e):n(String(e).split(u)),t},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,u,t){return u.toUpperCase()+t}),noop:()=>{},toFiniteNumber:(e,u)=>null!=e&&Number.isFinite(e=+e)?e:u,findKey:k,global:x,isContextDefined:T,ALPHABET:L,generateString:(e=16,u=L.ALPHA_DIGIT)=>{let t="";const{length:n}=u;for(;e--;)t+=u[Math.random()*n|0];return t},isSpecCompliantForm:function(e){return!!(e&&d(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const u=new Array(10),t=(e,n)=>{if(h(e)){if(u.indexOf(e)>=0)return;if(!("toJSON"in e)){u[n]=e;const r=c(e)?[]:{};return w(e,(e,u)=>{const o=t(e,n+1);!D(o)&&(r[u]=o)}),u[n]=void 0,r}}return e};return t(e,0)},isAsyncFn:U,isThenable:e=>e&&(h(e)||d(e))&&d(e.then)&&d(e.catch),setImmediate:W,asap:K};function J(e,u,t,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",u&&(this.code=u),t&&(this.config=t),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}G.inherits(J,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.status}}});const H=J.prototype,$={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{$[e]={value:e}}),Object.defineProperties(J,$),Object.defineProperty(H,"isAxiosError",{value:!0}),J.from=(e,u,t,n,r,o)=>{const a=Object.create(H);return G.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),J.call(a,e.message,u,t,n,r),a.cause=e,a.name=e.name,o&&Object.assign(a,o),a};var X=J;function Z(e){return G.isPlainObject(e)||G.isArray(e)}function Y(e){return G.endsWith(e,"[]")?e.slice(0,-2):e}function Q(e,u,t){return e?e.concat(u).map(function(e,u){return e=Y(e),!t&&u?"["+e+"]":e}).join(t?".":""):u}const ee=G.toFlatObject(G,{},null,function(e){return/^is[A-Z]/.test(e)});var ue=function(e,u,t){if(!G.isObject(e))throw new TypeError("target must be an object");u=u||new FormData;const n=(t=G.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,u){return!G.isUndefined(u[e])})).metaTokens,r=t.visitor||c,o=t.dots,a=t.indexes,i=(t.Blob||"undefined"!=typeof Blob&&Blob)&&G.isSpecCompliantForm(u);if(!G.isFunction(r))throw new TypeError("visitor must be a function");function s(e){if(null===e)return"";if(G.isDate(e))return e.toISOString();if(!i&&G.isBlob(e))throw new X("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(e)||G.isTypedArray(e)?i&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,t,r){let i=e;if(e&&!r&&"object"==typeof e)if(G.endsWith(t,"{}"))t=n?t:t.slice(0,-2),e=JSON.stringify(e);else if(G.isArray(e)&&function(e){return G.isArray(e)&&!e.some(Z)}(e)||(G.isFileList(e)||G.endsWith(t,"[]"))&&(i=G.toArray(e)))return t=Y(t),i.forEach(function(e,n){!G.isUndefined(e)&&null!==e&&u.append(!0===a?Q([t],n,o):null===a?t:t+"[]",s(e))}),!1;return!!Z(e)||(u.append(Q(r,t,o),s(e)),!1)}const D=[],l=Object.assign(ee,{defaultVisitor:c,convertValue:s,isVisitable:Z});if(!G.isObject(e))throw new TypeError("data must be an object");return function e(t,n){if(!G.isUndefined(t)){if(-1!==D.indexOf(t))throw Error("Circular reference detected in "+n.join("."));D.push(t),G.forEach(t,function(t,o){!0===(!(G.isUndefined(t)||null===t)&&r.call(u,t,G.isString(o)?o.trim():o,n,l))&&e(t,n?n.concat(o):[o])}),D.pop()}}(e),u};function te(e){const u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return u[e]})}function ne(e,u){this._pairs=[],e&&ue(e,this,u)}const re=ne.prototype;re.append=function(e,u){this._pairs.push([e,u])},re.toString=function(e){const u=e?function(u){return e.call(this,u,te)}:te;return this._pairs.map(function(e){return u(e[0])+"="+u(e[1])},"").join("&")};var oe=ne;function ae(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ie(e,u,t){if(!u)return e;const n=t&&t.encode||ae,r=t&&t.serialize;let o;if(o=r?r(u,t):G.isURLSearchParams(u)?u.toString():new oe(u,t).toString(n),o){const u=e.indexOf("#");-1!==u&&(e=e.slice(0,u)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}var se=class{constructor(){this.handlers=[]}use(e,u,t){return this.handlers.push({fulfilled:e,rejected:u,synchronous:!!t&&t.synchronous,runWhen:t?t.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){G.forEach(this.handlers,function(u){null!==u&&e(u)})}},ce={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},De={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:oe,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const le="undefined"!=typeof window&&"undefined"!=typeof document,fe="object"==typeof navigator&&navigator||void 0,de=le&&(!fe||["ReactNative","NativeScript","NS"].indexOf(fe.product)<0),Fe="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,he=le&&window.location.href||"http://localhost";var pe={...u,...De},Ee=function(e){function u(e,t,n,r){let o=e[r++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),i=r>=e.length;return o=!o&&G.isArray(n)?n.length:o,i?(G.hasOwnProp(n,o)?n[o]=[n[o],t]:n[o]=t,!a):(n[o]&&G.isObject(n[o])||(n[o]=[]),u(e,t,n[o],r)&&G.isArray(n[o])&&(n[o]=function(e){const u={},t=Object.keys(e);let n;const r=t.length;let o;for(n=0;n<r;n++)o=t[n],u[o]=e[o];return u}(n[o])),!a)}if(G.isFormData(e)&&G.isFunction(e.entries)){const t={};return G.forEachEntry(e,(e,n)=>{u(function(e){return G.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),n,t,0)}),t}return null};const Ae={transitional:ce,adapter:["xhr","http","fetch"],transformRequest:[function(e,u){const t=u.getContentType()||"",n=t.indexOf("application/json")>-1,r=G.isObject(e);if(r&&G.isHTMLForm(e)&&(e=new FormData(e)),G.isFormData(e))return n?JSON.stringify(Ee(e)):e;if(G.isArrayBuffer(e)||G.isBuffer(e)||G.isStream(e)||G.isFile(e)||G.isBlob(e)||G.isReadableStream(e))return e;if(G.isArrayBufferView(e))return e.buffer;if(G.isURLSearchParams(e))return u.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(r){if(t.indexOf("application/x-www-form-urlencoded")>-1)return function(e,u){return ue(e,new pe.classes.URLSearchParams,Object.assign({visitor:function(e,u,t,n){return pe.isNode&&G.isBuffer(e)?(this.append(u,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},u))}(e,this.formSerializer).toString();if((o=G.isFileList(e))||t.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return ue(o?{"files[]":e}:e,u&&new u,this.formSerializer)}}return r||n?(u.setContentType("application/json",!1),function(e){if(G.isString(e))try{return(0,JSON.parse)(e),G.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const u=this.transitional||Ae.transitional,t=u&&u.forcedJSONParsing,n="json"===this.responseType;if(G.isResponse(e)||G.isReadableStream(e))return e;if(e&&G.isString(e)&&(t&&!this.responseType||n)){const t=!(u&&u.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(e){if(t){if("SyntaxError"===e.name)throw X.from(e,X.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pe.classes.FormData,Blob:pe.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};G.forEach(["delete","get","head","post","put","patch"],e=>{Ae.headers[e]={}});var Ce=Ae;const ge=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ve=Symbol("internals");function me(e){return e&&String(e).trim().toLowerCase()}function ye(e){return!1===e||null==e?e:G.isArray(e)?e.map(ye):String(e)}function Be(e,u,t,n,r){return G.isFunction(n)?n.call(this,u,t):(r&&(u=t),G.isString(u)?G.isString(n)?-1!==u.indexOf(n):G.isRegExp(n)?n.test(u):void 0:void 0)}class be{constructor(e){e&&this.set(e)}set(e,u,t){const n=this;function r(e,u,t){const r=me(u);if(!r)throw new Error("header name must be a non-empty string");const o=G.findKey(n,r);(!o||void 0===n[o]||!0===t||void 0===t&&!1!==n[o])&&(n[o||u]=ye(e))}const o=(e,u)=>G.forEach(e,(e,t)=>r(e,t,u));if(G.isPlainObject(e)||e instanceof this.constructor)o(e,u);else if(G.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))o((e=>{const u={};let t,n,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),t=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!t||u[t]&&ge[t]||("set-cookie"===t?u[t]?u[t].push(n):u[t]=[n]:u[t]=u[t]?u[t]+", "+n:n)}),u})(e),u);else if(G.isHeaders(e))for(const[u,n]of e.entries())r(n,u,t);else null!=e&&r(u,e,t);return this}get(e,u){if(e=me(e)){const t=G.findKey(this,e);if(t){const e=this[t];if(!u)return e;if(!0===u)return function(e){const u=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(e);)u[n[1]]=n[2];return u}(e);if(G.isFunction(u))return u.call(this,e,t);if(G.isRegExp(u))return u.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,u){if(e=me(e)){const t=G.findKey(this,e);return!(!t||void 0===this[t]||u&&!Be(0,this[t],t,u))}return!1}delete(e,u){const t=this;let n=!1;function r(e){if(e=me(e)){const r=G.findKey(t,e);!r||u&&!Be(0,t[r],r,u)||(delete t[r],n=!0)}}return G.isArray(e)?e.forEach(r):r(e),n}clear(e){const u=Object.keys(this);let t=u.length,n=!1;for(;t--;){const r=u[t];e&&!Be(0,this[r],r,e,!0)||(delete this[r],n=!0)}return n}normalize(e){const u=this,t={};return G.forEach(this,(n,r)=>{const o=G.findKey(t,r);if(o)return u[o]=ye(n),void delete u[r];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,u,t)=>u.toUpperCase()+t)}(r):String(r).trim();a!==r&&delete u[r],u[a]=ye(n),t[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const u=Object.create(null);return G.forEach(this,(t,n)=>{null!=t&&!1!==t&&(u[n]=e&&G.isArray(t)?t.join(", "):t)}),u}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,u])=>e+": "+u).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...u){const t=new this(e);return u.forEach(e=>t.set(e)),t}static accessor(e){const u=(this[ve]=this[ve]={accessors:{}}).accessors,t=this.prototype;function n(e){const n=me(e);u[n]||(function(e,u){const t=G.toCamelCase(" "+u);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+t,{value:function(e,t,r){return this[n].call(this,u,e,t,r)},configurable:!0})})}(t,e),u[n]=!0)}return G.isArray(e)?e.forEach(n):n(e),this}}be.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),G.reduceDescriptors(be.prototype,({value:e},u)=>{let t=u[0].toUpperCase()+u.slice(1);return{get:()=>e,set(e){this[t]=e}}}),G.freezeMethods(be);var we=be;function ke(e,u){const t=this||Ce,n=u||t,r=we.from(n.headers);let o=n.data;return G.forEach(e,function(e){o=e.call(t,o,r.normalize(),u?u.status:void 0)}),r.normalize(),o}function xe(e){return!(!e||!e.__CANCEL__)}function Te(e,u,t){X.call(this,null==e?"canceled":e,X.ERR_CANCELED,u,t),this.name="CanceledError"}G.inherits(Te,X,{__CANCEL__:!0});var Oe=Te;function Se(e,u,t){const n=t.config.validateStatus;t.status&&n&&!n(t.status)?u(new X("Request failed with status code "+t.status,[X.ERR_BAD_REQUEST,X.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t)):e(t)}const _e=(e,u,t=3)=>{let n=0;const r=function(e,u){e=e||10;const t=new Array(e),n=new Array(e);let r,o=0,a=0;return u=void 0!==u?u:1e3,function(i){const s=Date.now(),c=n[a];r||(r=s),t[o]=i,n[o]=s;let D=a,l=0;for(;D!==o;)l+=t[D++],D%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),s-r<u)return;const f=c&&s-c;return f?Math.round(1e3*l/f):void 0}}(50,250);return function(e,u){let t,n,r=0,o=1e3/u;const a=(u,o=Date.now())=>{r=o,t=null,n&&(clearTimeout(n),n=null),e.apply(null,u)};return[(...e)=>{const u=Date.now(),i=u-r;i>=o?a(e,u):(t=e,n||(n=setTimeout(()=>{n=null,a(t)},o-i)))},()=>t&&a(t)]}(t=>{const o=t.loaded,a=t.lengthComputable?t.total:void 0,i=o-n,s=r(i);n=o,e({loaded:o,total:a,progress:a?o/a:void 0,bytes:i,rate:s||void 0,estimated:s&&a&&o<=a?(a-o)/s:void 0,event:t,lengthComputable:null!=a,[u?"download":"upload"]:!0})},t)},Re=(e,u)=>{const t=null!=e;return[n=>u[0]({lengthComputable:t,total:e,loaded:n}),u[1]]},je=e=>(...u)=>G.asap(()=>e(...u));var Pe=pe.hasStandardBrowserEnv?function(){const e=pe.navigator&&/(msie|trident)/i.test(pe.navigator.userAgent),u=document.createElement("a");let t;function n(t){let n=t;return e&&(u.setAttribute("href",n),n=u.href),u.setAttribute("href",n),{href:u.href,protocol:u.protocol?u.protocol.replace(/:$/,""):"",host:u.host,search:u.search?u.search.replace(/^\?/,""):"",hash:u.hash?u.hash.replace(/^#/,""):"",hostname:u.hostname,port:u.port,pathname:"/"===u.pathname.charAt(0)?u.pathname:"/"+u.pathname}}return t=n(window.location.href),function(e){const u=G.isString(e)?n(e):e;return u.protocol===t.protocol&&u.host===t.host}}():function(){return!0},Ie=pe.hasStandardBrowserEnv?{write(e,u,t,n,r,o){const a=[e+"="+encodeURIComponent(u)];G.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),G.isString(n)&&a.push("path="+n),G.isString(r)&&a.push("domain="+r),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read(e){const u=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return u?decodeURIComponent(u[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ne(e,u){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(u)?function(e,u){return u?e.replace(/\/?\/$/,"")+"/"+u.replace(/^\/+/,""):e}(e,u):u}const Le=e=>e instanceof we?{...e}:e;function Ue(e,u){u=u||{};const t={};function n(e,u,t){return G.isPlainObject(e)&&G.isPlainObject(u)?G.merge.call({caseless:t},e,u):G.isPlainObject(u)?G.merge({},u):G.isArray(u)?u.slice():u}function r(e,u,t){return G.isUndefined(u)?G.isUndefined(e)?void 0:n(void 0,e,t):n(e,u,t)}function o(e,u){if(!G.isUndefined(u))return n(void 0,u)}function a(e,u){return G.isUndefined(u)?G.isUndefined(e)?void 0:n(void 0,e):n(void 0,u)}function i(t,r,o){return o in u?n(t,r):o in e?n(void 0,t):void 0}const s={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:i,headers:(e,u)=>r(Le(e),Le(u),!0)};return G.forEach(Object.keys(Object.assign({},e,u)),function(n){const o=s[n]||r,a=o(e[n],u[n],n);G.isUndefined(a)&&o!==i||(t[n]=a)}),t}var We=e=>{const u=Ue({},e);let t,{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:s}=u;if(u.headers=i=we.from(i),u.url=ie(Ne(u.baseURL,u.url),e.params,e.paramsSerializer),s&&i.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),G.isFormData(n))if(pe.hasStandardBrowserEnv||pe.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(t=i.getContentType())){const[e,...u]=t?t.split(";").map(e=>e.trim()).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...u].join("; "))}if(pe.hasStandardBrowserEnv&&(r&&G.isFunction(r)&&(r=r(u)),r||!1!==r&&Pe(u.url))){const e=o&&a&&Ie.read(a);e&&i.set(o,e)}return u},Me="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(u,t){const n=We(e);let r=n.data;const o=we.from(n.headers).normalize();let a,i,s,c,D,{responseType:l,onUploadProgress:f,onDownloadProgress:d}=n;function F(){c&&c(),D&&D(),n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}let h=new XMLHttpRequest;function p(){if(!h)return;const n=we.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders());Se(function(e){u(e),F()},function(e){t(e),F()},{data:l&&"text"!==l&&"json"!==l?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:n,config:e,request:h}),h=null}h.open(n.method.toUpperCase(),n.url,!0),h.timeout=n.timeout,"onloadend"in h?h.onloadend=p:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(p)},h.onabort=function(){h&&(t(new X("Request aborted",X.ECONNABORTED,e,h)),h=null)},h.onerror=function(){t(new X("Network Error",X.ERR_NETWORK,e,h)),h=null},h.ontimeout=function(){let u=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const r=n.transitional||ce;n.timeoutErrorMessage&&(u=n.timeoutErrorMessage),t(new X(u,r.clarifyTimeoutError?X.ETIMEDOUT:X.ECONNABORTED,e,h)),h=null},void 0===r&&o.setContentType(null),"setRequestHeader"in h&&G.forEach(o.toJSON(),function(e,u){h.setRequestHeader(u,e)}),G.isUndefined(n.withCredentials)||(h.withCredentials=!!n.withCredentials),l&&"json"!==l&&(h.responseType=n.responseType),d&&([s,D]=_e(d,!0),h.addEventListener("progress",s)),f&&h.upload&&([i,c]=_e(f),h.upload.addEventListener("progress",i),h.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(a=u=>{h&&(t(!u||u.type?new Oe(null,e,h):u),h.abort(),h=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const E=function(e){const u=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return u&&u[1]||""}(n.url);E&&-1===pe.protocols.indexOf(E)?t(new X("Unsupported protocol "+E+":",X.ERR_BAD_REQUEST,e)):h.send(r||null)})},ze=(e,u)=>{const{length:t}=e=e?e.filter(Boolean):[];if(u||t){let t,n=new AbortController;const r=function(e){if(!t){t=!0,a();const u=e instanceof Error?e:this.reason;n.abort(u instanceof X?u:new Oe(u instanceof Error?u.message:u))}};let o=u&&setTimeout(()=>{o=null,r(new X(`timeout ${u} of ms exceeded`,X.ETIMEDOUT))},u);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:i}=n;return i.unsubscribe=()=>G.asap(a),i}};const qe=function*(e,u){let t=e.byteLength;if(!u||t<u)return void(yield e);let n,r=0;for(;r<t;)n=r+u,yield e.slice(r,n),r=n},Ve=(e,u,t,n)=>{const r=async function*(e,u){for await(const t of async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const u=e.getReader();try{for(;;){const{done:e,value:t}=await u.read();if(e)break;yield t}}finally{await u.cancel()}}(e))yield*qe(t,u)}(e,u);let o,a=0,i=e=>{o||(o=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:u,value:n}=await r.next();if(u)return i(),void e.close();let o=n.byteLength;if(t){let e=a+=o;t(e)}e.enqueue(new Uint8Array(n))}catch(e){throw i(e),e}},cancel(e){return i(e),r.return()}},{highWaterMark:2})},Ke="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,Ge=Ke&&"function"==typeof ReadableStream,Je=Ke&&("function"==typeof TextEncoder?(He=new TextEncoder,e=>He.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var He;const $e=(e,...u)=>{try{return!!e(...u)}catch(e){return!1}},Xe=Ge&&$e(()=>{let e=!1;const u=new Request(pe.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!u}),Ze=Ge&&$e(()=>G.isReadableStream(new Response("").body)),Ye={stream:Ze&&(e=>e.body)};var Qe;Ke&&(Qe=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ye[e]&&(Ye[e]=G.isFunction(Qe[e])?u=>u[e]():(u,t)=>{throw new X(`Response type '${e}' is not supported`,X.ERR_NOT_SUPPORT,t)})}));const eu={http:null,xhr:Me,fetch:Ke&&(async e=>{let{url:u,method:t,data:n,signal:r,cancelToken:o,timeout:a,onDownloadProgress:i,onUploadProgress:s,responseType:c,headers:D,withCredentials:l="same-origin",fetchOptions:f}=We(e);c=c?(c+"").toLowerCase():"text";let d,F=ze([r,o&&o.toAbortSignal()],a);const h=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let p;try{if(s&&Xe&&"get"!==t&&"head"!==t&&0!==(p=await(async(e,u)=>{const t=G.toFiniteNumber(e.getContentLength());return null==t?(async e=>{if(null==e)return 0;if(G.isBlob(e))return e.size;if(G.isSpecCompliantForm(e)){const u=new Request(pe.origin,{method:"POST",body:e});return(await u.arrayBuffer()).byteLength}return G.isArrayBufferView(e)||G.isArrayBuffer(e)?e.byteLength:(G.isURLSearchParams(e)&&(e+=""),G.isString(e)?(await Je(e)).byteLength:void 0)})(u):t})(D,n))){let e,t=new Request(u,{method:"POST",body:n,duplex:"half"});if(G.isFormData(n)&&(e=t.headers.get("content-type"))&&D.setContentType(e),t.body){const[e,u]=Re(p,_e(je(s)));n=Ve(t.body,65536,e,u)}}G.isString(l)||(l=l?"include":"omit");const r="credentials"in Request.prototype;d=new Request(u,{...f,signal:F,method:t.toUpperCase(),headers:D.normalize().toJSON(),body:n,duplex:"half",credentials:r?l:void 0});let o=await fetch(d);const a=Ze&&("stream"===c||"response"===c);if(Ze&&(i||a&&h)){const e={};["status","statusText","headers"].forEach(u=>{e[u]=o[u]});const u=G.toFiniteNumber(o.headers.get("content-length")),[t,n]=i&&Re(u,_e(je(i),!0))||[];o=new Response(Ve(o.body,65536,t,()=>{n&&n(),h&&h()}),e)}c=c||"text";let E=await Ye[G.findKey(Ye,c)||"text"](o,e);return!a&&h&&h(),await new Promise((u,t)=>{Se(u,t,{data:E,headers:we.from(o.headers),status:o.status,statusText:o.statusText,config:e,request:d})})}catch(u){if(h&&h(),u&&"TypeError"===u.name&&/fetch/i.test(u.message))throw Object.assign(new X("Network Error",X.ERR_NETWORK,e,d),{cause:u.cause||u});throw X.from(u,u&&u.code,e,d)}})};G.forEach(eu,(e,u)=>{if(e){try{Object.defineProperty(e,"name",{value:u})}catch(e){}Object.defineProperty(e,"adapterName",{value:u})}});const uu=e=>`- ${e}`,tu=e=>G.isFunction(e)||null===e||!1===e;var nu=e=>{e=G.isArray(e)?e:[e];const{length:u}=e;let t,n;const r={};for(let o=0;o<u;o++){let u;if(t=e[o],n=t,!tu(t)&&(n=eu[(u=String(t)).toLowerCase()],void 0===n))throw new X(`Unknown adapter '${u}'`);if(n)break;r[u||"#"+o]=n}if(!n){const e=Object.entries(r).map(([e,u])=>`adapter ${e} `+(!1===u?"is not supported by the environment":"is not available in the build"));let t=u?e.length>1?"since :\n"+e.map(uu).join("\n"):" "+uu(e[0]):"as no adapter specified";throw new X("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return n};function ru(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Oe(null,e)}function ou(e){return ru(e),e.headers=we.from(e.headers),e.data=ke.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),nu(e.adapter||Ce.adapter)(e).then(function(u){return ru(e),u.data=ke.call(e,e.transformResponse,u),u.headers=we.from(u.headers),u},function(u){return xe(u)||(ru(e),u&&u.response&&(u.response.data=ke.call(e,e.transformResponse,u.response),u.response.headers=we.from(u.response.headers))),Promise.reject(u)})}const au={};["object","boolean","number","function","string","symbol"].forEach((e,u)=>{au[e]=function(t){return typeof t===e||"a"+(u<1?"n ":" ")+e}});const iu={};au.transitional=function(e,u,t){function n(e,u){return"[Axios v1.7.7] Transitional option '"+e+"'"+u+(t?". "+t:"")}return(t,r,o)=>{if(!1===e)throw new X(n(r," has been removed"+(u?" in "+u:"")),X.ERR_DEPRECATED);return u&&!iu[r]&&(iu[r]=!0,console.warn(n(r," has been deprecated since v"+u+" and will be removed in the near future"))),!e||e(t,r,o)}};var su={assertOptions:function(e,u,t){if("object"!=typeof e)throw new X("options must be an object",X.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const o=n[r],a=u[o];if(a){const u=e[o],t=void 0===u||a(u,o,e);if(!0!==t)throw new X("option "+o+" must be "+t,X.ERR_BAD_OPTION_VALUE);continue}if(!0!==t)throw new X("Unknown option "+o,X.ERR_BAD_OPTION)}},validators:au};const cu=su.validators;class Du{constructor(e){this.defaults=e,this.interceptors={request:new se,response:new se}}async request(e,u){try{return await this._request(e,u)}catch(e){if(e instanceof Error){let u;Error.captureStackTrace?Error.captureStackTrace(u={}):u=new Error;const t=u.stack?u.stack.replace(/^.+\n/,""):"";try{e.stack?t&&!String(e.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+t):e.stack=t}catch(e){}}throw e}}_request(e,u){"string"==typeof e?(u=u||{}).url=e:u=e||{},u=Ue(this.defaults,u);const{transitional:t,paramsSerializer:n,headers:r}=u;void 0!==t&&su.assertOptions(t,{silentJSONParsing:cu.transitional(cu.boolean),forcedJSONParsing:cu.transitional(cu.boolean),clarifyTimeoutError:cu.transitional(cu.boolean)},!1),null!=n&&(G.isFunction(n)?u.paramsSerializer={serialize:n}:su.assertOptions(n,{encode:cu.function,serialize:cu.function},!0)),u.method=(u.method||this.defaults.method||"get").toLowerCase();let o=r&&G.merge(r.common,r[u.method]);r&&G.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),u.headers=we.concat(o,r);const a=[];let i=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(u)||(i=i&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const s=[];let c;this.interceptors.response.forEach(function(e){s.push(e.fulfilled,e.rejected)});let D,l=0;if(!i){const e=[ou.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,s),D=e.length,c=Promise.resolve(u);l<D;)c=c.then(e[l++],e[l++]);return c}D=a.length;let f=u;for(l=0;l<D;){const e=a[l++],u=a[l++];try{f=e(f)}catch(e){u.call(this,e);break}}try{c=ou.call(this,f)}catch(e){return Promise.reject(e)}for(l=0,D=s.length;l<D;)c=c.then(s[l++],s[l++]);return c}getUri(e){return ie(Ne((e=Ue(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}G.forEach(["delete","get","head","options"],function(e){Du.prototype[e]=function(u,t){return this.request(Ue(t||{},{method:e,url:u,data:(t||{}).data}))}}),G.forEach(["post","put","patch"],function(e){function u(u){return function(t,n,r){return this.request(Ue(r||{},{method:e,headers:u?{"Content-Type":"multipart/form-data"}:{},url:t,data:n}))}}Du.prototype[e]=u(),Du.prototype[e+"Form"]=u(!0)});var lu=Du;class fu{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let u;this.promise=new Promise(function(e){u=e});const t=this;this.promise.then(e=>{if(!t._listeners)return;let u=t._listeners.length;for(;u-- >0;)t._listeners[u](e);t._listeners=null}),this.promise.then=e=>{let u;const n=new Promise(e=>{t.subscribe(e),u=e}).then(e);return n.cancel=function(){t.unsubscribe(u)},n},e(function(e,n,r){t.reason||(t.reason=new Oe(e,n,r),u(t.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const u=this._listeners.indexOf(e);-1!==u&&this._listeners.splice(u,1)}toAbortSignal(){const e=new AbortController,u=u=>{e.abort(u)};return this.subscribe(u),e.signal.unsubscribe=()=>this.unsubscribe(u),e.signal}static source(){let e;return{token:new fu(function(u){e=u}),cancel:e}}}var du=fu;const Fu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Fu).forEach(([e,u])=>{Fu[u]=e});var hu=Fu;const pu=function e(u){const n=new lu(u),r=t(lu.prototype.request,n);return G.extend(r,lu.prototype,n,{allOwnKeys:!0}),G.extend(r,n,null,{allOwnKeys:!0}),r.create=function(t){return e(Ue(u,t))},r}(Ce);pu.Axios=lu,pu.CanceledError=Oe,pu.CancelToken=du,pu.isCancel=xe,pu.VERSION="1.7.7",pu.toFormData=ue,pu.AxiosError=X,pu.Cancel=pu.CanceledError,pu.all=function(e){return Promise.all(e)},pu.spread=function(e){return function(u){return e.apply(null,u)}},pu.isAxiosError=function(e){return G.isObject(e)&&!0===e.isAxiosError},pu.mergeConfig=Ue,pu.AxiosHeaders=we,pu.formToJSON=e=>Ee(G.isHTMLForm(e)?new FormData(e):e),pu.getAdapter=nu,pu.HttpStatusCode=hu,pu.default=pu;var Eu,Au,Cu,gu=pu;function vu(e){return vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vu(e)}function mu(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);u&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,n)}return t}function yu(e){for(var u=1;u<arguments.length;u++){var t=null!=arguments[u]?arguments[u]:{};u%2?mu(Object(t),!0).forEach(function(u){Bu(e,u,t[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mu(Object(t)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(t,u))})}return e}function Bu(e,u,t){return(u=Ou(u))in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function bu(){var e,u,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function o(t,n,r,o){var s=n&&n.prototype instanceof i?n:i,c=Object.create(s.prototype);return wu(c,"_invoke",function(t,n,r){var o,i,s,c=0,D=r||[],l=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(u,t){return o=u,i=0,s=e,f.n=t,a}};function d(t,n){for(i=t,s=n,u=0;!l&&c&&!r&&u<D.length;u++){var r,o=D[u],d=f.p,F=o[2];t>3?(r=F===n)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=d&&((r=t<2&&d<o[1])?(i=0,f.v=n,f.n=o[1]):d<F&&(r=t<3||o[0]>n||n>F)&&(o[4]=t,o[5]=n,f.n=F,i=0))}if(r||t>1)return a;throw l=!0,n}return function(r,D,F){if(c>1)throw TypeError("Generator is already running");for(l&&1===D&&d(D,F),i=D,s=F;(u=i<2?e:s)||!l;){o||(i?i<3?(i>1&&(f.n=-1),d(i,s)):f.n=s:f.v=s);try{if(c=2,o){if(i||(r="next"),u=o[r]){if(!(u=u.call(o,s)))throw TypeError("iterator result is not an object");if(!u.done)return u;s=u.value,i<2&&(i=0)}else 1===i&&(u=o.return)&&u.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((u=(l=f.n<0)?s:t.call(n,f))!==a)break}catch(u){o=e,i=1,s=u}finally{c=1}}return{value:u,done:l}}}(t,r,o),!0),c}var a={};function i(){}function s(){}function c(){}u=Object.getPrototypeOf;var D=[][n]?u(u([][n]())):(wu(u={},n,function(){return this}),u),l=c.prototype=i.prototype=Object.create(D);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,wu(e,r,"GeneratorFunction")),e.prototype=Object.create(l),e}return s.prototype=c,wu(l,"constructor",c),wu(c,"constructor",s),s.displayName="GeneratorFunction",wu(c,r,"GeneratorFunction"),wu(l),wu(l,r,"Generator"),wu(l,n,function(){return this}),wu(l,"toString",function(){return"[object Generator]"}),(bu=function(){return{w:o,m:f}})()}function wu(e,u,t,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}wu=function(e,u,t,n){function o(u,t){wu(e,u,function(e){return this._invoke(u,t,e)})}u?r?r(e,u,{value:t,enumerable:!n,configurable:!n,writable:!n}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},wu(e,u,t,n)}function ku(e,u,t,n,r,o,a){try{var i=e[o](a),s=i.value}catch(e){return void t(e)}i.done?u(s):Promise.resolve(s).then(n,r)}function xu(e){return function(){var u=this,t=arguments;return new Promise(function(n,r){var o=e.apply(u,t);function a(e){ku(o,n,r,a,i,"next",e)}function i(e){ku(o,n,r,a,i,"throw",e)}a(void 0)})}}function Tu(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,n=Array(u);t<u;t++)n[t]=e[t];return n}function Ou(e){var u=function(e){if("object"!=vu(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=vu(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==vu(u)?u:u+""}function Su(e){var u="function"==typeof Map?new Map:void 0;return Su=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(u){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==u){if(u.has(e))return u.get(e);u.set(e,t)}function t(){return function(e,u,t){if(_u())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,u);var r=new(e.bind.apply(e,n));return t&&Ru(r,t.prototype),r}(e,arguments,ju(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Ru(t,e)},Su(e)}function _u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_u=function(){return!!e})()}function Ru(e,u){return Ru=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,u){return e.__proto__=u,e},Ru(e,u)}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ju(e)}var Pu,Iu="undefined"!=typeof window&&"boolean"==typeof window.__VEJICE_DEBUG__?window.__VEJICE_DEBUG__:void 0,Nu="boolean"==typeof Iu?Iu:!("undefined"!=typeof process&&"production"===(null===(Pu=process.env)||void 0===Pu?void 0:"production")||"undefined"!=typeof window&&"production"===window.__VEJICE_ENV__),Lu=function(){for(var e,u=arguments.length,t=new Array(u),n=0;n<u;n++)t[n]=arguments[n];return Nu&&(e=console).log.apply(e,["[Vejice API]"].concat(t))},Uu=function(e){return"string"==typeof e?e.slice(0,120):e},Wu="undefined"!=typeof process&&(null===(Eu=process.env)||void 0===Eu?void 0:"vejice_API_beta")||"undefined"!=typeof window&&window.__VEJICE_API_KEY||"",Mu=function(e){return new Promise(function(u){setTimeout(u,e)})},zu="undefined"!=typeof process?function(e){if("boolean"==typeof e)return e;if("string"==typeof e){var u=e.trim().toLowerCase();if(!u)return;if(["1","true","yes","on"].includes(u))return!0;if(["0","false","no","off"].includes(u))return!1}}(null!==(Au=null===(Cu=process.env)||void 0===Cu?void 0:"")&&void 0!==Au?Au:""):void 0,qu="undefined"!=typeof window&&"boolean"==typeof window.__VEJICE_USE_MOCK__?window.__VEJICE_USE_MOCK__:void 0,Vu=!1;"boolean"==typeof qu?Vu=qu:"boolean"==typeof zu&&(Vu=zu);var Ku=function(e){function u(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,u){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),(t=function(e,u,t){return u=ju(u),function(e,u){if(u&&("object"==vu(u)||"function"==typeof u))return u;if(void 0!==u)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_u()?Reflect.construct(u,t||[],ju(e).constructor):u.apply(e,t))}(this,u,[e])).name="VejiceApiError",t.meta=n,n.cause&&(t.cause=n.cause),t}return function(e,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(u&&u.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),u&&Ru(e,u)}(u,e),t=u,Object.defineProperty(t,"prototype",{writable:!1}),t;var t}(Su(Error));function Gu(e){var u,t,n=null==e||null===(u=e.response)||void 0===u?void 0:u.status,r=null==e?void 0:e.code,o=null==e||null===(t=e.response)||void 0===t?void 0:t.data;return{status:n,code:r,msg:null==e?void 0:e.message,dataPreview:"string"==typeof o?Uu(o):o&&Object.keys(o)}}var Ju=["ki","ker","ko","kjer","da","zato","toda"];function Hu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1?arguments[1]:void 0;if(!e||!u)return null;var t=e.toLowerCase(),n=" ".concat(u.toLowerCase()),r=t.indexOf(n);if(r>0){var o=e[r-1];if(o&&","!==o&&"\n"!==o)return e.slice(0,r)+","+e.slice(r)}return null}function $u(){var e,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=function(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,u){if(e){if("string"==typeof e)return Tu(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Tu(e,u):void 0}}(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw o}}}}(Ju);try{for(t.s();!(e=t.n()).done;){var n=Hu(u,e.value);if(n)return u=n}}catch(e){t.e(e)}finally{t.f()}var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=e.indexOf(", ,");if(u>=0)return e.slice(0,u)+e.slice(u+1);var t=e.indexOf(", in");return t>=0?e.slice(0,t)+e.slice(t+1):null}(u);return r||u}function Xu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"t";if("string"!=typeof e||!e.length)return[];for(var t,n=[],r=/[^\s]+/g,o=1;t=r.exec(e);)n.push({token_id:"".concat(u).concat(o++),token:t[0],start_char:t.index,end_char:t.index+t[0].length});return n}function Zu(){return Yu.apply(this,arguments)}function Yu(){return Yu=xu(bu().m(function e(){var u,t=arguments;return bu().w(function(e){for(;;)if(0===e.n)return u=t.length>0&&void 0!==t[0]?t[0]:"",e.a(2,new Promise(function(e){setTimeout(function(){var t=$u(u);e({correctedText:t,raw:{source_text:u,target_text:t,source_tokens:Xu(u,"s"),target_tokens:Xu(t,"t")}})},350)}))},e)})),Yu.apply(this,arguments)}function Qu(e){var u,t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[r.popravljeno_besedilo,r.target_text,null===(u=r.popravki)||void 0===u||null===(u=u[0])||void 0===u?void 0:u.predlog,Array.isArray(r.corrections)?null===(t=r.corrections[0])||void 0===t?void 0:t.suggested_text:void 0,Array.isArray(r.apply_corrections)?null===(n=r.apply_corrections[0])||void 0===n?void 0:n.suggested_text:void 0].map(function(e){return"string"==typeof e?e.trim():""}).find(function(e){return e})||e}function et(e){var u=null==e?void 0:e.status;if("number"==typeof u&&u>=500&&u<600)return!0;var t="string"==typeof(null==e?void 0:e.code)?e.code.toUpperCase():"";return!!t&&["ECONNABORTED","ETIMEDOUT","ERR_NETWORK"].includes(t)}function ut(e){return tt.apply(this,arguments)}function tt(){return(tt=xu(bu().m(function e(u){var t,n,r,o,a,i,s,c,D,l,f,d,F,h,p,E,A,C,g,v,m,y,B,b,w,k;return bu().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!Vu){e.n=1;break}return Lu("Mock API ->",Uu(u)),e.a(2,Zu(u));case 1:if(Wu){e.n=2;break}throw new Ku("Missing VEJICE_API_KEY configuration");case 2:t="https://gpu-proc1.cjvt.si/popravljalnik-api/postavi_vejice",n={vhodna_poved:u,hkratne_napovedi:!0,"ne_označi_imen":!1,"prepričanost_modela":.08},r={headers:{"Content-Type":"application/json",Accept:"application/json","X-API-KEY":Wu},timeout:15e3},o=Math.max(1,3),a=1;case 3:if(!(a<=o)){e.n=10;break}return D=null!==(i=null===(s=performance)||void 0===s||null===(c=s.now)||void 0===c?void 0:c.call(s))&&void 0!==i?i:Date.now(),e.p=4,Lu("POST",t,"| len:",null!==(l=null==u?void 0:u.length)&&void 0!==l?l:0,"| snippet:",Uu(u),"| attempt:",a),e.n=5,gu.post(t,n,r);case 5:return h=e.v,p=null!==(f=null===(d=performance)||void 0===d||null===(F=d.now)||void 0===F?void 0:F.call(d))&&void 0!==f?f:Date.now(),E=yu({},(null==h?void 0:h.data)||{}),A=Qu(u,E),"string"!=typeof E.source_text&&(E.source_text=u),"string"!=typeof E.target_text&&(E.target_text=A),Lu("OK","".concat(Math.round(p-D)," ms"),"| status:",null==h?void 0:h.status,"| changed:",A!==u,"| keys:",E&&Object.keys(E),"| sourceTokens:",Array.isArray(null==E?void 0:E.source_tokens)?E.source_tokens.length:0,"| targetTokens:",Array.isArray(null==E?void 0:E.target_tokens)?E.target_tokens.length:0,"| attempt:",a),e.a(2,{correctedText:A,raw:E});case 6:if(e.p=6,k=e.v,m=null!==(C=null===(g=performance)||void 0===g||null===(v=g.now)||void 0===v?void 0:v.call(g))&&void 0!==C?C:Date.now(),y=Math.round(m-D),B=Gu(k),b=a<o&&et(B),Lu("ERROR","".concat(y," ms"),yu(yu({},B),{},{attempt:a,retryable:b})),!b){e.n=8;break}return Lu("Retrying Vejice API request in",w=400*a,"ms"),e.n=7,Mu(w);case 7:return e.a(3,9);case 8:throw new Ku("Vejice API call failed",{durationMs:y,info:B,attempt:a,cause:k});case 9:a++,e.n=3;break;case 10:return e.a(2)}},e,null,[[4,6]])}))).apply(this,arguments)}function nt(e){return rt.apply(this,arguments)}function rt(){return(rt=xu(bu().m(function e(u){var t,n;return bu().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ut(u);case 1:return t=e.v,n=t.correctedText,e.a(2,n)}},e)}))).apply(this,arguments)}function ot(e){return at.apply(this,arguments)}function at(){return(at=xu(bu().m(function e(u){var t,n,r;return bu().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ut(u);case 1:return t=e.v,n=t.correctedText,r=t.raw,e.a(2,{correctedText:n,raw:r,sourceTokens:Array.isArray(null==r?void 0:r.source_tokens)?r.source_tokens:[],targetTokens:Array.isArray(null==r?void 0:r.target_tokens)?r.target_tokens:[],sourceText:"string"==typeof(null==r?void 0:r.source_text)?r.source_text:u,targetText:"string"==typeof(null==r?void 0:r.target_text)?r.target_text:n})}},e)}))).apply(this,arguments)}var it,st=function(){var e,u,t=null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e?void 0:e.platform;return t===(null===(u=Office)||void 0===u||null===(u=u.PlatformType)||void 0===u?void 0:u.OfficeOnline)||"OfficeOnline"===t};function ct(e){if(null!=e){var u=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],t=0;if(u)return u.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}throw new TypeError(gt(e)+" is not iterable")}function Dt(e){return function(e){if(Array.isArray(e))return Ct(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||At(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(){var e,u,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function o(t,n,r,o){var s=n&&n.prototype instanceof i?n:i,c=Object.create(s.prototype);return ft(c,"_invoke",function(t,n,r){var o,i,s,c=0,D=r||[],l=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(u,t){return o=u,i=0,s=e,f.n=t,a}};function d(t,n){for(i=t,s=n,u=0;!l&&c&&!r&&u<D.length;u++){var r,o=D[u],d=f.p,F=o[2];t>3?(r=F===n)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=d&&((r=t<2&&d<o[1])?(i=0,f.v=n,f.n=o[1]):d<F&&(r=t<3||o[0]>n||n>F)&&(o[4]=t,o[5]=n,f.n=F,i=0))}if(r||t>1)return a;throw l=!0,n}return function(r,D,F){if(c>1)throw TypeError("Generator is already running");for(l&&1===D&&d(D,F),i=D,s=F;(u=i<2?e:s)||!l;){o||(i?i<3?(i>1&&(f.n=-1),d(i,s)):f.n=s:f.v=s);try{if(c=2,o){if(i||(r="next"),u=o[r]){if(!(u=u.call(o,s)))throw TypeError("iterator result is not an object");if(!u.done)return u;s=u.value,i<2&&(i=0)}else 1===i&&(u=o.return)&&u.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((u=(l=f.n<0)?s:t.call(n,f))!==a)break}catch(u){o=e,i=1,s=u}finally{c=1}}return{value:u,done:l}}}(t,r,o),!0),c}var a={};function i(){}function s(){}function c(){}u=Object.getPrototypeOf;var D=[][n]?u(u([][n]())):(ft(u={},n,function(){return this}),u),l=c.prototype=i.prototype=Object.create(D);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ft(e,r,"GeneratorFunction")),e.prototype=Object.create(l),e}return s.prototype=c,ft(l,"constructor",c),ft(c,"constructor",s),s.displayName="GeneratorFunction",ft(c,r,"GeneratorFunction"),ft(l),ft(l,r,"Generator"),ft(l,n,function(){return this}),ft(l,"toString",function(){return"[object Generator]"}),(lt=function(){return{w:o,m:f}})()}function ft(e,u,t,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ft=function(e,u,t,n){function o(u,t){ft(e,u,function(e){return this._invoke(u,t,e)})}u?r?r(e,u,{value:t,enumerable:!n,configurable:!n,writable:!n}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},ft(e,u,t,n)}function dt(e,u){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);u&&(n=n.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,n)}return t}function Ft(e){for(var u=1;u<arguments.length;u++){var t=null!=arguments[u]?arguments[u]:{};u%2?dt(Object(t),!0).forEach(function(u){ht(e,u,t[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dt(Object(t)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(t,u))})}return e}function ht(e,u,t){return(u=function(e){var u=function(e){if("object"!=gt(e)||!e)return e;var u=e[Symbol.toPrimitive];if(void 0!==u){var t=u.call(e,"string");if("object"!=gt(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==gt(u)?u:u+""}(u))in e?Object.defineProperty(e,u,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[u]=t,e}function pt(e,u){return function(e){if(Array.isArray(e))return e}(e)||function(e,u){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,r,o,a,i=[],s=!0,c=!1;try{if(o=(t=t.call(e)).next,0===u){if(Object(t)!==t)return;s=!1}else for(;!(s=(n=o.call(t)).done)&&(i.push(n.value),i.length!==u);s=!0);}catch(e){c=!0,r=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return i}}(e,u)||At(e,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,u){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=At(e))||u&&e&&"number"==typeof e.length){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw o}}}}function At(e,u){if(e){if("string"==typeof e)return Ct(e,u);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ct(e,u):void 0}}function Ct(e,u){(null==u||u>e.length)&&(u=e.length);for(var t=0,n=Array(u);t<u;t++)n[t]=e[t];return n}function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function vt(e,u,t,n,r,o,a){try{var i=e[o](a),s=i.value}catch(e){return void t(e)}i.done?u(s):Promise.resolve(s).then(n,r)}function mt(e){return function(){var u=this,t=arguments;return new Promise(function(n,r){var o=e.apply(u,t);function a(e){vt(o,n,r,a,i,"next",e)}function i(e){vt(o,n,r,a,i,"throw",e)}a(void 0)})}}var yt="undefined"!=typeof window&&"boolean"==typeof window.__VEJICE_DEBUG__?window.__VEJICE_DEBUG__:void 0,Bt="boolean"==typeof yt?yt:!function(){var e;return"undefined"!=typeof process&&"production"===(null===(e=process.env)||void 0===e?void 0:"production")||"undefined"!=typeof window&&"production"===window.__VEJICE_ENV__}(),bt=function(){for(var e,u=arguments.length,t=new Array(u),n=0;n<u;n++)t[n]=arguments[n];return Bt&&(e=console).log.apply(e,["[Vejice CHECK]"].concat(t))},wt=function(){for(var e,u=arguments.length,t=new Array(u),n=0;n<u;n++)t[n]=arguments[n];return Bt&&(e=console).warn.apply(e,["[Vejice CHECK]"].concat(t))},kt=function(){for(var e,u=arguments.length,t=new Array(u),n=0;n<u;n++)t[n]=arguments[n];return(e=console).error.apply(e,["[Vejice CHECK]"].concat(t))},xt=function(){var e,u,t;return null!==(e=null===(u=performance)||void 0===u||null===(t=u.now)||void 0===t?void 0:t.call(u))&&void 0!==e?e:Date.now()},Tt=function(e){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80;return"string"==typeof e?e.slice(0,u):e},Ot="undefined"!=typeof Office&&"PC"===(null===(it=Office)||void 0===it||null===(it=it.context)||void 0===it?void 0:it.platform)?3:2,St=/[\u00A0\u202F\u2007]/g,_t=/[,\s]+$/,Rt=/^[\s"'“”„()«»]+/g,jt=/[\s,.;:!?'"“”„()«»]+$/g;function Pt(e){return"string"==typeof e&&e.length?e.replace(St," "):"string"==typeof e?e:""}function It(e){return"string"!=typeof e?"":e.replace(Rt,"").replace(jt,"").trim().toLowerCase()}var Nt=[],Lt=3e3,Ut=!1,Wt=!1;function Mt(){Nt.length=0}function zt(e){Nt.push(e)}function qt(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Nt.map(function(e){return{id:null==e?void 0:e.id,kind:null==e?void 0:e.kind,paragraphIndex:null==e?void 0:e.paragraphIndex,metadata:null==e?void 0:e.metadata,originalPos:null==e?void 0:e.originalPos,leftWord:null==e?void 0:e.leftWord,leftSnippet:null==e?void 0:e.leftSnippet,rightSnippet:null==e?void 0:e.rightSnippet}}):Nt}"undefined"!=typeof window&&(window.__VEJICE_DEBUG_STATE__=window.__VEJICE_DEBUG_STATE__||{},window.__VEJICE_DEBUG_STATE__.getPendingSuggestionsOnline=qt,window.__VEJICE_DEBUG_STATE__.getParagraphAnchorsOnline=function(){return on},window.getPendingSuggestionsOnline=qt,window.getPendingSuggestionsSnapshot=function(){return qt(!0)});var Vt=new Set;function Kt(){Vt.clear()}function Gt(e){"number"==typeof e&&e>=0&&Vt.add(e)}var Jt=null;function Ht(e){var u;if(e)if("undefined"!=typeof Office&&null!==(u=Office.context)&&void 0!==u&&null!==(u=u.ui)&&void 0!==u&&u.displayDialogAsync){var t="undefined"!=typeof window&&window.location&&window.location.origin||null;if(t){var n=new URL("toast.html",t);n.searchParams.set("message",e),Office.context.ui.displayDialogAsync(n.toString(),{height:20,width:30,displayInIframe:!0},function(e){if(e.status===Office.AsyncResultStatus.Succeeded){if(Jt)try{Jt.close()}catch(e){wt("Toast notification: failed to close previous dialog",e)}var u=function(){if(Jt)try{Jt.close()}catch(e){wt("Toast notification: failed to close dialog",e)}finally{Jt=null}};(Jt=e.value).addEventHandler(Office.EventType.DialogMessageReceived,u),Jt.addEventHandler(Office.EventType.DialogEventReceived,u)}else wt("Toast notification failed",e.error)})}else wt("Toast notification: origin unavailable")}else wt("Toast notification unavailable",e)}function $t(e,u){var t="Odstavek ".concat(e+1,": ").concat("Odstavek je predolg za preverjanje. Razdelite ga na krajše povedi in poskusite znova."," (").concat(u," znakov).");wt("Paragraph too long – skipped",{paragraphIndex:e,length:u}),Ht(t)}function Xt(e,u){var t="Odstavek ".concat(e+1,": ").concat("Poved je predolga za preverjanje. Razdelite jo na krajše povedi in poskusite znova."," (").concat(u," znakov).");wt("Sentence too long – skipped",{paragraphIndex:e,length:u}),Ut||(Ut=!0,Ht(t))}function Zt(e,u){var t=u+1,n="Odstavek ".concat(e+1,", poved ").concat(t,": ").concat("Nekaterih povedi ni bilo mogoče preveriti zaradi napake strežnika. Ostale povedi so bile preverjene.");wt("Sentence skipped due to API error",{paragraphIndex:e,chunkIndex:u}),Wt||(Wt=!0,Ht(n))}function Yt(e,u,t,n){var r=u+1,o="Odstavek ".concat(e+1,", poved ").concat(r,": API je spremenil več kot vejice. Preglejte poved ročno.");wt("Sentence skipped due to non-comma changes",{paragraphIndex:e,chunkIndex:u,original:t,corrected:n}),Ht(o)}function Qt(){wt("Tracked changes present – aborting check"),Ht("Najprej sprejmite ali zavrnite obstoječe spremembe (Track Changes), nato ponovno zaženite preverjanje.")}var en=!1;function un(){en||(en=!0,wt("API unavailable – notifying toast"),Ht("Storitev CJVT Vejice trenutno ni na voljo. Znova poskusite kasneje."))}function tn(){en=!1,Ut=!1,Wt=!1}function nn(e){return rn.apply(this,arguments)}function rn(){return(rn=mt(lt().m(function e(u){var t,n;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null!=u&&u.document){e.n=1;break}return e.a(2,!1);case 1:if(!st()){e.n=2;break}return e.a(2,!1);case 2:if((t=u.document.revisions)&&"function"==typeof t.load){e.n=3;break}return e.a(2,!1);case 3:return e.p=3,t.load("items"),e.n=4,u.sync();case 4:return e.a(2,t.items.length>0);case 5:if(e.p=5,"ApiNotFound"!==(null==(n=e.v)?void 0:n.code)){e.n=6;break}return wt("Revisions API unavailable on this host – skipping tracked changes guard"),e.a(2,!1);case 6:throw n;case 7:return e.a(2)}},e,null,[[3,5]])}))).apply(this,arguments)}var on=[];function an(){on.length=0}function sn(e){return on[e]}function cn(e){var u=e.paragraphIndex,t=e.originalText,n=void 0===t?"":t,r=e.correctedText,o=void 0===r?"":r,a=e.sourceTokens,i=void 0===a?[]:a,s=e.targetTokens,c=void 0===s?[]:s,D=e.documentOffset,l=void 0===D?0:D,f="string"==typeof n?n:"",d="string"==typeof o?o:"",F=Dn(i,"s"),h=Dn(c,"t"),p={paragraphIndex:u,documentOffset:l,originalText:f,correctedText:d,sourceTokens:F,targetTokens:h,sourceAnchors:fn(u,f,F,l),targetAnchors:fn(u,d,h,l)};return function(e,u){on[e]=u}(u,p),p}function Dn(e,u){if(!Array.isArray(e))return[];for(var t=[],n=0;n<e.length;n++){var r=ln(e[n],u,n);r&&t.push(r)}return t}function ln(e,u,t){if(null==e)return null;if("string"==typeof e)return{id:"".concat(u).concat(t+1),text:e,raw:e};if("object"===gt(e)){var n,r,o,a,i,s,c,D,l,f,d,F,h,p,E,A,C,g,v,m=null!==(n=null!==(r=null!==(o=null!==(a=null!==(i=e.token_id)&&void 0!==i?i:e.tokenId)&&void 0!==a?a:e.id)&&void 0!==o?o:e.ID)&&void 0!==r?r:e.name)&&void 0!==n?n:e.key,y=null!==(s=null!==(c=null!==(D=null!==(l=null!==(f=e.token)&&void 0!==f?f:e.text)&&void 0!==l?l:e.form)&&void 0!==D?D:e.value)&&void 0!==c?c:e.surface)&&void 0!==s?s:e.word,B=null!==(d=null!==(F=null!==(h=null!==(p=null!==(E=e.whitespace)&&void 0!==E?E:e.trailing_ws)&&void 0!==p?p:e.trailingWhitespace)&&void 0!==h?h:e.after)&&void 0!==F?F:e.space)&&void 0!==d?d:"",b=null!==(A=null!==(C=null!==(g=null!==(v=e.leading_ws)&&void 0!==v?v:e.leadingWhitespace)&&void 0!==g?g:e.before)&&void 0!==C?C:e.prefix)&&void 0!==A?A:"";return{id:"string"==typeof m?m:"".concat(u).concat(t+1),text:"string"==typeof y?y:"",trailingWhitespace:"string"==typeof B?B:"",leadingWhitespace:"string"==typeof b?b:"",raw:e}}return null}function fn(e,u,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=Object.create(null),o=[];if(!Array.isArray(t)||!t.length)return{byId:r,ordered:o};for(var a=Pt("string"==typeof u?u:""),i=Object.create(null),s=Object.create(null),c=0,D=0;D<t.length;D++){var l,f,d,F,h=t[D],p=null!==(l=null==h?void 0:h.text)&&void 0!==l?l:"",E=null!==(f=null==h?void 0:h.id)&&void 0!==f?f:"tok".concat(D+1),A=p.length,C=Fn(a,p,c),g=C>=0?C+A:-1;C>=0?c=g:p&&wt("Token mapping failed",{paragraphIndex:e,tokenId:E,tokenText:p,cursor:c});var v=p||"",m=v.trim(),y=null!==(d=i[v])&&void 0!==d?d:0;i[v]=y+1;var B=m&&m!==v?null!==(F=s[m])&&void 0!==F?F:0:y;m&&m!==v&&(s[m]=B+1);var b={paragraphIndex:e,tokenId:E,tokenIndex:D,tokenText:p,length:A,textOccurrence:y,trimmedTextOccurrence:m?B:y,charStart:C,charEnd:g,documentCharStart:C>=0?n+C:-1,documentCharEnd:g>=0?n+g:-1,matched:C>=0,repeatKey:It(p)};r[E]=b,o.push(b)}return function(e){if(Array.isArray(e)&&e.length){var u,t=Object.create(null),n=Object.create(null),r=Et(e);try{for(r.s();!(u=r.n()).done;){var o,a=u.value,i=null==a?void 0:a.repeatKey;i&&(t[i]=(null!==(o=t[i])&&void 0!==o?o:0)+1,n[i]=n[i]||[],"number"==typeof a.charStart&&a.charStart>=0&&n[i].push(a.charStart))}}catch(e){r.e(e)}finally{r.f()}for(var s=Object.create(null),c=0,D=Object.entries(n);c<D.length;c++){var l=pt(D[c],2),f=l[0],d=l[1];if(Array.isArray(d)&&!(d.length<2)){for(var F=d.slice().sort(function(e,u){return e-u}),h=new Map,p=0;p<F.length;p++){var E=1/0;p>0&&(E=Math.min(E,F[p]-F[p-1])),p<F.length-1&&(E=Math.min(E,F[p+1]-F[p])),h.set(F[p],E)}s[f]=h}}var A,C=Et(e);try{for(C.s();!(A=C.n()).done;){var g,v=A.value;if(v){var m=v.repeatKey;if(v.repeatKeyTotal=m&&null!==(g=t[m])&&void 0!==g?g:0,m&&s[m]&&"number"==typeof v.charStart){var y=s[m].get(v.charStart);v.repeatKeyNearestGap="number"==typeof y?y:1/0}else v.repeatKeyNearestGap=1/0}}}catch(e){C.e(e)}finally{C.f()}}}(o),{byId:r,ordered:o}}function dn(e,u){if(!Array.isArray(e)||!u)return null;var t=e.findIndex(function(e){return(null==e?void 0:e.tokenId)===u});if(t<=0)return null;for(var n=t-1;n>=0;n--){var r=e[n];if(null!=r&&r.tokenText&&r.tokenText.trim())return r}return null}function Fn(e,u,t){if(!u||"string"!=typeof e)return-1;var n=e.length;if(!n)return-1;var r=t;r<0&&(r=0),r>n&&(r=n);var o=e.indexOf(u,r);if(-1!==o)return o;var a=u.trim();if(a&&a!==u&&-1!==(o=e.indexOf(a,r)))return o;if(r>0){var i=Math.max(0,r-u.length-1);if(-1!==(o=e.indexOf(u,i)))return o}return e.indexOf(u)}function hn(e){if(e)return{tokenId:e.tokenId,tokenIndex:e.tokenIndex,tokenText:e.tokenText,textOccurrence:e.textOccurrence,trimmedTextOccurrence:e.trimmedTextOccurrence,charStart:e.charStart,charEnd:e.charEnd,documentCharStart:e.documentCharStart,documentCharEnd:e.documentCharEnd,length:e.length,matched:e.matched,repeatKey:e.repeatKey,repeatKeyTotal:e.repeatKeyTotal,repeatKeyNearestGap:e.repeatKeyNearestGap}}function pn(e,u,t){var n,r=function(e,u){return e?"target"===u?e.targetAnchors:e.sourceAnchors:null}(e,u);if(null==r||null===(n=r.ordered)||void 0===n||!n.length||"number"!=typeof t||t<0)return{before:null,at:null,after:null};for(var o=null,a=0;a<r.ordered.length;a++){var i=r.ordered[a];if(i&&!(i.charStart<0)){if(t>=i.charStart&&t<=i.charEnd)return{before:null!=o?o:i,at:i,after:En(r.ordered,a+1)};if(i.charStart>t)return{before:o,at:null,after:i};o=i}}return{before:o,at:null,after:null}}function En(e,u){if(!Array.isArray(e))return null;for(var t=u;t<e.length;t++){var n=e[t];if(n&&n.charStart>=0)return n}return null}function An(e,u,t){if(!u)return 0;for(var n="string"==typeof e?e:"",r=Math.max(1,u.length),o=0,a=n.indexOf(u);-1!==a&&a<t;)o++,a=n.indexOf(u,a+r);return o}function Cn(e,u,t,n,r){return gn.apply(this,arguments)}function gn(){return gn=mt(lt().m(function e(u,t,n,r,o){var a,i,s,c,D,l,f,d,F,h,p,E,A,C,g=arguments;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a=g.length>5&&void 0!==g[5]?g[5]:"span",i=g.length>6?g[6]:void 0,t&&"function"==typeof t.getRange){e.n=1;break}return e.a(2,null);case 1:if(Number.isFinite(r)&&!(r<0)){e.n=2;break}return e.a(2,null);case 2:if(s="string"==typeof n?n:t.text||""){e.n=3;break}return e.a(2,null);case 3:if(c=Math.max(0,Math.min(Math.floor(r),s.length?s.length-1:0)),D=Math.max(c+1,Math.floor(null!=o?o:c+1)),l=Math.min(D,s.length),!(f=s.slice(c,l))&&"string"==typeof i&&i.length&&(f=i),f){e.n=4;break}return e.a(2,null);case 4:return e.p=4,h=f,e.n=5,yn(u,t,h);case 5:if(p=e.v,null!==(d=p)&&void 0!==d&&null!==(d=d.items)&&void 0!==d&&d.length||!f.trim()||f.trim()===f){e.n=7;break}return h=f.trim(),e.n=6,yn(u,t,h);case 6:p=e.v;case 7:if(null!==(F=p)&&void 0!==F&&null!==(F=F.items)&&void 0!==F&&F.length){e.n=8;break}return wt("getRangeForCharacterSpan(".concat(a,"): snippet not found"),{snippet:f,safeStart:c}),e.a(2,null);case 8:return E=An(s,f,c),A=Math.min(E,p.items.length-1),e.a(2,p.items[A]);case 9:return e.p=9,C=e.v,wt("getRangeForCharacterSpan(".concat(a,") failed"),C),e.a(2,null)}},e,null,[[4,9]])})),gn.apply(this,arguments)}function vn(e,u,t,n,r){return mn.apply(this,arguments)}function mn(){return mn=mt(lt().m(function e(u,t,n,r,o){var a,i,s,c,D,l,f,d,F=arguments;return lt().w(function(e){for(;;)switch(e.n){case 0:a=F.length>5&&void 0!==F[5]?F[5]:"span",i=F.length>6?F[6]:void 0,s=[],null!=n&&n.originalText&&s.push({text:n.originalText,label:"orig"}),!(c=null==t?void 0:t.text)||s.length&&c===s[0].text||s.push({text:c,label:"live"}),s.length||s.push({text:"",label:"empty"}),D=0,l=s;case 1:if(!(D<l.length)){e.n=5;break}if((f=l[D]).text){e.n=2;break}return e.a(3,4);case 2:return e.n=3,Cn(u,t,f.text,r,o,"".concat(a,"-").concat(f.label),i);case 3:if(!(d=e.v)){e.n=4;break}return e.a(2,d);case 4:D++,e.n=1;break;case 5:return e.a(2,null)}},e)})),mn.apply(this,arguments)}function yn(e,u,t){return Bn.apply(this,arguments)}function Bn(){return(Bn=mt(lt().m(function e(u,t,n){var r,o;return lt().w(function(e){for(;;)switch(e.n){case 0:return r=t.getRange(),(o=r.search(n,{matchCase:!0,matchWholeWord:!1,ignoreSpace:!1,ignorePunct:!1})).load("items"),e.n=1,u.sync();case 1:return e.a(2,o)}},e)}))).apply(this,arguments)}function bn(e,u){var t,n,r,o=pn(e,"source",u),a=null!==(t=null==e?void 0:e.documentOffset)&&void 0!==t?t:0,i=Math.max(0,u),s=i+1,c=(null!==(n=null==e?void 0:e.originalText)&&void 0!==n?n:"").slice(i,s)||",";return{kind:"delete",paragraphIndex:null!==(r=null==e?void 0:e.paragraphIndex)&&void 0!==r?r:-1,charStart:i,charEnd:s,documentCharStart:a+i,documentCharEnd:a+s,sourceTokenBefore:hn(o.before),sourceTokenAt:hn(o.at),sourceTokenAfter:hn(o.after),highlightText:c}}function wn(e,u){var t,n,r,o,a,i,s,c,D,l,f=u.originalCharIndex,d=u.targetCharIndex,F="number"==typeof f?f:-1,h="number"==typeof d?d:F,p=pn(e,"source",F),E=pn(e,"target",h),A=null!==(t=null==e?void 0:e.documentOffset)&&void 0!==t?t:0,C=null!==(n=null!==(r=null!==(o=null!==(a=null!==(i=p.at)&&void 0!==i?i:p.before)&&void 0!==a?a:p.after)&&void 0!==o?o:E.at)&&void 0!==r?r:E.before)&&void 0!==n?n:E.after,g=null!==(s=null==C?void 0:C.charStart)&&void 0!==s?s:F,v=null!==(c=null==C?void 0:C.charEnd)&&void 0!==c?c:F,m=null!==(D=null==e?void 0:e.originalText)&&void 0!==D?D:"",y="";return g>=0&&v>g&&(y=m.slice(g,v)),!y&&g>=0&&(y=m.slice(g,g+1)),{kind:"insert",paragraphIndex:null!==(l=null==e?void 0:e.paragraphIndex)&&void 0!==l?l:-1,targetCharStart:h,targetCharEnd:h>=0?h+1:h,targetDocumentCharStart:h>=0?A+h:h,targetDocumentCharEnd:h>=0?A+h+1:h,highlightCharStart:g,highlightCharEnd:v,highlightText:y,sourceTokenBefore:hn(p.before),sourceTokenAt:hn(p.at),sourceTokenAfter:hn(p.after),targetTokenBefore:hn(E.before),targetTokenAt:hn(E.at),targetTokenAfter:hn(E.after),highlightAnchorTarget:hn(C)}}function kn(e){var u=[];if(!e)return u;var t=function(e,t,n){if(Number.isFinite(e)&&!(e<0)){var r=Number.isFinite(t)&&t>e?t:e+1;u.push({start:e,end:r,snippet:n})}};return t(e.highlightCharStart,e.highlightCharEnd,e.highlightText),t(e.charStart,e.charEnd,e.highlightText),e.highlightAnchorTarget&&t(e.highlightAnchorTarget.charStart,e.highlightAnchorTarget.charEnd,e.highlightAnchorTarget.tokenText),u}function xn(e){var u=[];if(!e)return u;var t=function(e,t,n){if(Number.isFinite(e)&&!(e<0)){var r=Number.isFinite(t)&&t>e?t:e+1;u.push({start:e,end:r,snippet:n})}},n=function(e){e&&t(e.charStart,e.charEnd,e.tokenText)};return t(e.highlightCharStart,e.highlightCharEnd,e.highlightText),t(e.targetCharStart,e.targetCharEnd,e.highlightText),t(e.charStart,e.charEnd,e.highlightText),n(e.highlightAnchorTarget),n(e.sourceTokenAt),n(e.targetTokenAt),n(e.sourceTokenBefore),n(e.targetTokenBefore),u}var Tn,On,Sn=new Set(['"',"'","“","”","„","«","»"]),_n=function(e){return e>="0"&&e<="9"},Rn=function(e,u){return u>=0&&u<e.length?e[u]:""};function jn(e){return"string"!=typeof e?"":e.replace(/\s+/g,"").replace(/,/g,"").replace(/[()]/g,"")}function Pn(e,u){return jn(e)===jn(u)}function In(e,u){if("string"!=typeof e||u<0||u>=e.length)return-1;for(var t=u,n=!1;t<e.length&&/\s/.test(e[t]);)n=!0,t++;return!n||t>=e.length?-1:","===e[t]?t:-1}function Nn(e){var u="string"==typeof e?e:"",t=u.match(_t),n=t?t[0]:"";return{base:n?u.slice(0,-n.length):u,trailing:n,hasComma:n.includes(",")}}function Ln(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=Nn(e),n=Nn(u);return t.hasComma===n.hasComma?null:{removeComma:t.hasComma&&!n.hasComma,addComma:!t.hasComma&&n.hasComma,originalSegment:e,correctedSegment:u,baseText:t.base||n.base}}function Un(){return{tokenIds:new Set,unmatchedTokenIds:new Set,intents:[]}}function Wn(e){return"string"!=typeof e?"":e.replace(/[.,!?;:“”„'"«»]/g,"").replace(/\s+/g," ").trim()}function Mn(e,u,t,n){var r;if(null==e||!e.corrections||!u)return[];var o=Array.isArray(e.corrections)?e.corrections:"object"===gt(e.corrections)?Object.values(e.corrections):[];if(!o.length)return[];var a,i=[],s=new Set,c=Et(o);try{for(c.s();!(a=c.n()).done;){var D,l=a.value,f=Et(Array.isArray(null==l?void 0:l.corrections)?l.corrections:[]);try{for(f.s();!(D=f.n()).done;){var d,F,h,p,E=D.value,A=Ln(null==E?void 0:E.source_text,null==E?void 0:E.text);if(A){var C=null!==(d=null==E?void 0:E.source_id)&&void 0!==d?d:null==l?void 0:l.source_start;if(C){null!=n&&n.tokenIds&&n.tokenIds.add(C);var g=null==u||null===(F=u.sourceAnchors)||void 0===F||null===(F=F.byId)||void 0===F?void 0:F[C];if(!g||!g.matched||g.charStart<0)null!=n&&n.unmatchedTokenIds&&n.unmatchedTokenIds.add(C);else{var v=null!==(h=g.tokenText)&&void 0!==h?h:"",m="string"==typeof(null==E?void 0:E.source_text)?E.source_text:"",y=g;if(m&&v&&Wn(m)!==Wn(v)){var B,b=zn(m,g,null==u||null===(B=u.sourceAnchors)||void 0===B?void 0:B.ordered);if(!b)continue;y=b}var w=(m&&m.length?m:v)||"";if(A.addComma&&(!w||!w.trim())&&null!=u&&null!==(p=u.sourceAnchors)&&void 0!==p&&null!==(p=p.ordered)&&void 0!==p&&p.length){var k,x=dn(u.sourceAnchors.ordered,g.tokenId);x&&(y=x,w=null!==(k=x.tokenText)&&void 0!==k?k:w)}if(w){if(null!=n&&n.intents&&n.intents.push({tokenId:C,anchor:y,analysis:A,baseText:w}),A.removeComma){var T=w.lastIndexOf(",");if(T<0){null!=n&&n.unmatchedTokenIds&&n.unmatchedTokenIds.add(C);continue}var O=y.charStart+T,S="del-".concat(O);if(s.has(S))continue;s.add(S),i.push({kind:"delete",pos:O,originalPos:O,correctedPos:O,paragraphIndex:t,fromCorrections:!0})}else if(A.addComma){var _="string"==typeof A.baseText&&Wn(A.baseText)?A.baseText:null,R=(null!=_?_:w).replace(_t,"").length,j=y.charStart+R,P="ins-".concat(j);if(s.has(P))continue;s.add(P),i.push({kind:"insert",pos:j,originalPos:j,correctedPos:j,paragraphIndex:t,fromCorrections:!0})}}else null!=n&&n.unmatchedTokenIds&&n.unmatchedTokenIds.add(C)}}}}}catch(e){f.e(e)}finally{f.f()}}}catch(e){c.e(e)}finally{c.f()}if(n&&null!==(r=n.intents)&&void 0!==r&&r.length){n.blockedOriginalPositions=new Set(n.blockedOriginalPositions||[]),n.blockedCorrectedPositions=new Set(n.blockedCorrectedPositions||[]);var I,N=Et(n.intents);try{for(N.s();!(I=N.n()).done;){var L,U,W,M,z=I.value,q=null==z?void 0:z.anchor;if(q){var V=null!==(L=null!==(U=null!==(W=z.baseText)&&void 0!==W?W:null===(M=z.analysis)||void 0===M?void 0:M.baseText)&&void 0!==U?U:q.tokenText)&&void 0!==L?L:"",K=q.charStart;if(!("number"!=typeof K||K<0)&&V){var G=V.lastIndexOf(",");G>=0&&n.blockedOriginalPositions.add(K+G);var J=V.replace(_t,"").length;n.blockedCorrectedPositions.add(K+J)}}}}catch(e){N.e(e)}finally{N.f()}}return i}function zn(e,u,t){var n,r;if(!e||!u||null==t||!t.length)return null;var o=Wn(e);if(!o)return null;var a=null!==(n=u.tokenText)&&void 0!==n?n:"",i=Wn(a);if(i===o)return u;for(var s=u.tokenIndex-1,c=u.tokenIndex+1,D=u,l=e.length+20;a.length<=l;){var f=!1;if(s>=0){var d,F=t[s];if(s--,null!=(null==F?void 0:F.tokenText)&&(D=F,f=!0,(i=Wn(a=(null!==(d=F.tokenText)&&void 0!==d?d:"")+a))===o))break}if(i===o)break;if(c<t.length){var h,p=t[c];if(c++,null!=(null==p?void 0:p.tokenText)&&(f=!0,(i=Wn(a+=null!==(h=p.tokenText)&&void 0!==h?h:""))===o))break}if(!f)break}return i!==o||"number"!=typeof(null===(r=D)||void 0===r?void 0:r.charStart)||D.charStart<0?null:Ft(Ft({},u),{},{charStart:D.charStart,tokenIndex:D.tokenIndex,tokenText:a})}function qn(e,u){for(var t=[],n=0,r=0;n<e.length||r<u.length;){var o,a,i=null!==(o=e[n])&&void 0!==o?o:"",s=null!==(a=u[r])&&void 0!==a?a:"";if(i!==s)if(","!==s||","===i)if(","!==i||","===s)i&&n++,s&&r++;else{if(/\s/.test(s)){var c=In(u,r);if(c>=0){r=c;continue}}t.push({kind:"delete",pos:n,originalPos:n,correctedPos:r}),n++}else{if(/\s/.test(i)){var D=In(e,n);if(D>=0){n=D;continue}}t.push({kind:"insert",pos:r,originalPos:n,correctedPos:r}),r++}else n++,r++}return t}function Vn(e,u,t){return t.filter(function(t){if(function(e,u,t,n){var r="delete"===t?e:u,o=Rn(r,n-1),a=Rn(r,n+1);return _n(o)&&_n(a)}(e,u,t.kind,t.pos))return!1;if("insert"===t.kind){var n=Rn(u,t.pos+1);if(n&&!/\s/.test(n)&&!Sn.has(n))return!0}return!0})}function Kn(e){if(!Array.isArray(e)||e.length<2)return e;var u=e.filter(function(e){return"delete"===(null==e?void 0:e.kind)}).map(function(e){return"number"==typeof e.originalPos?e.originalPos:e.pos}).filter(function(e){return"number"==typeof e});return u.length?e.filter(function(e){if("insert"!==(null==e?void 0:e.kind))return!0;var t="number"==typeof e.originalPos?e.originalPos:e.pos;return"number"!=typeof t||!function(e){return u.some(function(u){return"number"==typeof u&&Math.abs(u-e)<=0})}(t)}):e}function Gn(e,u){if(!u||!Array.isArray(e)||!e.length)return e;var t=u.blockedOriginalPositions,n=u.blockedCorrectedPositions;return null!=t&&t.size||null!=n&&n.size?e.filter(function(e){var u="number"==typeof e.originalPos?e.originalPos:e.pos,r="number"==typeof e.correctedPos?e.correctedPos:e.pos;return!("delete"===e.kind&&null!=t&&t.has(u)||"insert"===e.kind&&null!=n&&n.has(r))}):e}function Jn(e,u){var t,n;if(null!=u&&u.fromCorrections)return!1;var r=function(e,u){var t,n,r;if(!e||!u)return null;var o="delete"===u.kind,a=o?null!==(t=u.originalPos)&&void 0!==t?t:u.pos:null!==(n=u.correctedPos)&&void 0!==n?n:u.pos;if("number"!=typeof a||a<0)return null;var i=pn(e,o?"source":"target",a);return null!==(r=null==i?void 0:i.at)&&void 0!==r?r:null}(e,u);if(!r)return!1;var o=r.repeatKey,a=null!==(t=r.repeatKeyTotal)&&void 0!==t?t:0;return!(!o||a<=1||!/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2\uDFF3]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])+/.test(o)||(null!==(n=r.repeatKeyNearestGap)&&void 0!==n?n:1/0)>80)}function Hn(e,u){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;return{left:e.slice(Math.max(0,u-t),u),right:e.slice(u,Math.min(e.length,u+t))}}function $n(e,u,t,n,r){return Xn.apply(this,arguments)}function Xn(){return(Xn=mt(lt().m(function e(u,t,n,r,o){var a,i,s,c,D,l;return lt().w(function(e){for(;;)switch(e.n){case 0:if(a=Hn(r,o),i=a.left,s=a.right,c=t.getRange(),!(i.length>0)){e.n=3;break}return(D=c.search(i,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=1,u.sync();case 1:if(D.items.length){e.n=2;break}return wt("insert: left anchor not found"),e.a(2);case 2:D.items[0].getRange("After").insertText(",",Word.InsertLocation.before),e.n=7;break;case 3:if(s){e.n=4;break}return wt("insert: no right anchor at paragraph start"),e.a(2);case 4:return(l=c.search(s,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=5,u.sync();case 5:if(l.items.length){e.n=6;break}return wt("insert: right anchor not found"),e.a(2);case 6:l.items[0].getRange("Before").insertText(",",Word.InsertLocation.before);case 7:return e.a(2)}},e)}))).apply(this,arguments)}function Zn(e,u,t,n){return Yn.apply(this,arguments)}function Yn(){return(Yn=mt(lt().m(function e(u,t,n,r){var o,a,i,s,c,D,l;return lt().w(function(e){for(;;)switch(e.n){case 0:if((o=Rn(n,r+1))&&!/\s/.test(o)&&!Sn.has(o)&&!_n(o)){e.n=1;break}return e.a(2);case 1:if(a=Hn(n,r+1),i=a.left,s=a.right,c=t.getRange(),!(i.length>0)){e.n=4;break}return(D=c.search(i,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=2,u.sync();case 2:if(D.items.length){e.n=3;break}return wt("space-after: left anchor not found"),e.a(2);case 3:D.items[0].getRange("Before").insertText(" ",Word.InsertLocation.before),e.n=7;break;case 4:if(!(s.length>0)){e.n=7;break}return(l=c.search(s,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=5,u.sync();case 5:if(l.items.length){e.n=6;break}return wt("space-after: right anchor not found"),e.a(2);case 6:l.items[0].getRange("Before").insertText(" ",Word.InsertLocation.before);case 7:return e.a(2)}},e)}))).apply(this,arguments)}function Qn(e,u,t,n){return er.apply(this,arguments)}function er(){return(er=mt(lt().m(function e(u,t,n,r){var o,a,i,s,c;return lt().w(function(e){for(;;)switch(e.n){case 0:for(o=t.getRange(),a=0,i=0;i<=r&&i<n.length;i++)","===n[i]&&a++;if(0!==a){e.n=1;break}return wt("delete: no comma found in original at pos",r),e.a(2);case 1:return(s=o.search(",",{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=2,u.sync();case 2:if(!((c=a-1)>=s.items.length)){e.n=3;break}return wt("delete: comma ordinal out of range",a,"/",s.items.length),e.a(2);case 3:s.items[c].insertText("",Word.InsertLocation.replace);case 4:return e.a(2)}},e)}))).apply(this,arguments)}function ur(e,u,t){return"".concat(e,"-").concat(u,"-").concat(t,"-").concat(Nt.length)}function tr(e,u,t,n,r,o,a){return nr.apply(this,arguments)}function nr(){return(nr=mt(lt().m(function e(u,t,n,r,o,a,i){return lt().w(function(e){for(;;)switch(e.n){case 0:if("delete"!==o.kind){e.n=1;break}return e.a(2,or(u,t,n,o,a,i));case 1:return e.a(2,ir(u,t,r,o,a,i))}},e)}))).apply(this,arguments)}function rr(e,u){for(var t=0,n=0;n<=u&&n<e.length;n++)","===e[n]&&t++;return t}function or(e,u,t,n,r,o){return ar.apply(this,arguments)}function ar(){return(ar=mt(lt().m(function e(u,t,n,r,o,a){var i,s,c;return lt().w(function(e){for(;;)switch(e.n){case 0:return s=bn(a,null!==(i=r.originalPos)&&void 0!==i?i:r.pos),e.n=1,Cn(u,t,n,s.charStart,s.charEnd,"highlight-delete",s.highlightText);case 1:if(c=e.v){e.n=3;break}return e.n=2,cr(u,t,n,r);case 2:if(c=e.v){e.n=3;break}return e.a(2,!1);case 3:return c.font.highlightColor="#FFCDD2",u.trackedObjects.add(c),zt({id:ur("del",o,r.pos),kind:"delete",paragraphIndex:o,originalPos:r.pos,highlightRange:c,metadata:s}),Gt(o),e.a(2,!0)}},e)}))).apply(this,arguments)}function ir(e,u,t,n,r,o){return sr.apply(this,arguments)}function sr(){return(sr=mt(lt().m(function e(u,t,n,r,o,a){var i,s,c,D,l,f,d,F,h,p,E,A,C,g,v,m,y,B,b;return lt().w(function(e){for(;;)switch(e.n){case 0:if(c=wn(a,{originalCharIndex:null!==(i=r.originalPos)&&void 0!==i?i:r.pos,targetCharIndex:null!==(s=r.correctedPos)&&void 0!==s?s:r.pos}),D=Hn(n,r.pos),l=D.left||"",f=D.right||n.slice(r.pos,r.pos+24),d=l.slice(-40),F=f.slice(0,40),h=lr(l),p=l.slice(-20).replace(/[\r\n]+/g," "),E={matchCase:!1,matchWholeWord:!1},A=null,!(c.highlightCharStart>=0)){e.n=2;break}return v=c.highlightCharEnd>c.highlightCharStart?c.highlightCharEnd:c.highlightCharStart+1,e.n=1,Cn(u,t,null!==(C=null!==(g=null==a?void 0:a.originalText)&&void 0!==g?g:t.text)&&void 0!==C?C:n,c.highlightCharStart,v,"highlight-insert-meta",c.highlightText);case 1:A=e.v;case 2:if(A||!h){e.n=4;break}return(m=t.getRange().search(h,{matchCase:!1,matchWholeWord:!0})).load("items"),e.n=3,u.sync();case 3:m.items.length&&(A=m.items[m.items.length-1]);case 4:if(A||!p.trim()){e.n=6;break}return(y=t.getRange().search(p.trim(),E)).load("items"),e.n=5,u.sync();case 5:y.items.length&&(A=y.items[y.items.length-1]);case 6:if(A){e.n=8;break}if(!(B=(B=F.replace(/,/g,"").trim()).slice(0,8))){e.n=8;break}return(b=t.getRange().search(B,E)).load("items"),e.n=7,u.sync();case 7:b.items.length&&(A=b.items[0]);case 8:if(A){e.n=9;break}return e.a(2,!1);case 9:try{A=A.getRange("Content")}catch(e){wt("highlight insert: failed to focus range",e)}return A.font.highlightColor="#FFF9C4",u.trackedObjects.add(A),zt({id:ur("ins",o,r.pos),kind:"insert",paragraphIndex:o,leftWord:h,leftSnippet:d,rightSnippet:F,highlightRange:A,metadata:c}),Gt(o),e.a(2,!0)}},e)}))).apply(this,arguments)}function cr(e,u,t,n){return Dr.apply(this,arguments)}function Dr(){return(Dr=mt(lt().m(function e(u,t,n,r){var o,a;return lt().w(function(e){for(;;)switch(e.n){case 0:if(!((o=rr(n,r.pos))<=0)){e.n=1;break}return wt("highlight delete: no comma ordinal",r),e.a(2,null);case 1:return(a=t.getRange().search(",",{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=2,u.sync();case 2:if(a.items.length&&!(o>a.items.length)){e.n=3;break}return wt("highlight delete: comma search out of range"),e.a(2,null);case 3:return e.a(2,a.items[o-1])}},e)}))).apply(this,arguments)}function lr(e){var u=e.match(/((?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2\uDFF3]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])+)(?:[\0-\/:-@\[-`\{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u036F\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482-\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u05CF\u05EB-\u05EE\u05F3-\u061F\u064B-\u066D\u0670\u06D4\u06D6-\u06E4\u06E7-\u06ED\u06F0-\u06F9\u06FD\u06FE\u0700-\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07C9\u07EB-\u07F3\u07F6-\u07F9\u07FB-\u07FF\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u083F\u0859-\u085F\u086B-\u086F\u0888\u0890-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0970\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09EF\u09F2-\u09FB\u09FD-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A71\u0A75-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B70\u0B72-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5E\u0C5F\u0C62-\u0C7F\u0C81-\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDB\u0CDF\u0CE2-\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D4F-\u0D53\u0D57-\u0D5E\u0D62-\u0D79\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0E00\u0E31\u0E34-\u0E3F\u0E47-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0EDB\u0EE0-\u0EFF\u0F01-\u0F3F\u0F48\u0F6D-\u0F87\u0F8D-\u0FFF\u102B-\u103E\u1040-\u104F\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16F0\u16F9-\u16FF\u1712-\u171E\u1732-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u194F\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19FF\u1A17-\u1A1F\u1A55-\u1AA6\u1AA8-\u1B04\u1B34-\u1B44\u1B4D-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BFF\u1C24-\u1C4C\u1C50-\u1C59\u1C7E\u1C7F\u1C8B-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2182\u2185-\u2BFF\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2E2E\u2E30-\u3004\u3007-\u3030\u3036-\u303A\u303D-\u3040\u3097-\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31C0-\u31EF\u3200-\u33FF\u4DC0-\u4DFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA620-\uA629\uA62C-\uA63F\uA66F-\uA67E\uA69E\uA69F\uA6E6-\uA716\uA720\uA721\uA789\uA78A\uA7DD-\uA7F0\uA802\uA806\uA80B\uA823-\uA83F\uA874-\uA881\uA8B4-\uA8F1\uA8F8-\uA8FA\uA8FC\uA8FF-\uA909\uA926-\uA92F\uA947-\uA95F\uA97D-\uA983\uA9B3-\uA9CE\uA9D0-\uA9DF\uA9E5\uA9F0-\uA9F9\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA5F\uAA77-\uAA79\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAADE\uAADF\uAAEB-\uAAF1\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABE3-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFE6F\uFE75\uFEFD-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEFF\uDF20-\uDF2C\uDF41\uDF4A-\uDF4F\uDF76-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0-\uDFFF]|\uD801[\uDC9E-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6F\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDBF\uDDF4-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56-\uDC5F\uDC77-\uDC7F\uDC9F-\uDCDF\uDCF3\uDCF6-\uDCFF\uDD16-\uDD1F\uDD3A-\uDD3F\uDD5A-\uDD7F\uDDB8-\uDDBD\uDDC0-\uDDFF\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE5F\uDE7D-\uDE7F\uDE9D-\uDEBF\uDEC8\uDEE5-\uDEFF\uDF36-\uDF3F\uDF56-\uDF5F\uDF73-\uDF7F\uDF92-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCFF\uDD24-\uDD49\uDD66-\uDD6E\uDD86-\uDE7F\uDEAA-\uDEAF\uDEB2-\uDEC1\uDEC8-\uDEFF\uDF1D-\uDF26\uDF28-\uDF2F\uDF46-\uDF6F\uDF82-\uDFAF\uDFC5-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCCF\uDCE9-\uDD02\uDD27-\uDD43\uDD45\uDD46\uDD48-\uDD4F\uDD73-\uDD75\uDD77-\uDD82\uDDB3-\uDDC0\uDDC5-\uDDD9\uDDDB\uDDDD-\uDDFF\uDE12\uDE2C-\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEDF-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDF7F\uDF8A\uDF8C\uDF8D\uDF8F\uDFB6\uDFB8-\uDFD0\uDFD2\uDFD4-\uDFFF]|\uD805[\uDC35-\uDC46\uDC4B-\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC6\uDCC8-\uDD7F\uDDAF-\uDDD7\uDDDC-\uDDFF\uDE30-\uDE43\uDE45-\uDE7F\uDEAB-\uDEB7\uDEB9-\uDEFF\uDF1B-\uDF3F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC9F\uDCE0-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE2\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE9C\uDE9E-\uDEAF\uDEF9-\uDFBF\uDFE1-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC41-\uDC71\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDDAF\uDDDC-\uDEDF\uDEF3-\uDF01\uDF03\uDF11\uDF34-\uDFAF\uDFB1-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC00-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD812-\uD817\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD834\uD836\uD83C-\uD83F\uD87C\uD87D\uD87F\uD88E-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF1-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDC5F]|\uD810[\uDFFB-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD818[\uDC00-\uDCFF\uDD1E-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F-\uDE6F\uDEBF-\uDECF\uDEEE-\uDEFF\uDF30-\uDF3F\uDF44-\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDD3F\uDD6D-\uDE3F\uDE80-\uDE9F\uDEB9\uDEBA\uDED4-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE2\uDFE4-\uDFF1\uDFF4-\uDFFF]|\uD823[\uDCD6-\uDCFE\uDD1F-\uDD7F\uDDF3-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC-\uDFFF]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E-\uDD4D\uDD4F-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDDCF\uDDEE\uDDEF\uDDF1-\uDEBF\uDEDF\uDEE3\uDEE6\uDEEE\uDEEF\uDEF5-\uDEFD\uDF00-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5-\uDCFF\uDD44-\uDD4A\uDD4C-\uDFFF]|\uD83B[\uDC00-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEAE\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD88D[\uDC7A-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*$/);return u?u[1]:""}function fr(e,u,t){return dr.apply(this,arguments)}function dr(){return(dr=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c,D,l,f,d,F,h;return lt().w(function(e){for(;;)switch(e.n){case 0:if(i=null==n?void 0:n.metadata){e.n=1;break}return e.a(2,!1);case 1:if(s=sn(n.paragraphIndex),!(Number.isFinite(i.charStart)&&i.charStart>=0)){e.n=3;break}return e.n=2,vn(u,t,s,i.charStart,Number.isFinite(i.charEnd)&&i.charEnd>i.charStart?i.charEnd:i.charStart+1,"apply-delete-char",i.highlightText);case 2:if(!(c=e.v)){e.n=3;break}return c.insertText("",Word.InsertLocation.replace),e.a(2,!0);case 3:if(!(D=(null===(r=i.sourceTokenAt)||void 0===r||null===(r=r.tokenText)||void 0===r?void 0:r.includes(","))&&i.sourceTokenAt||(null===(o=i.sourceTokenAfter)||void 0===o||null===(o=o.tokenText)||void 0===o?void 0:o.includes(","))&&i.sourceTokenAfter||(null===(a=i.sourceTokenBefore)||void 0===a||null===(a=a.tokenText)||void 0===a?void 0:a.includes(","))&&i.sourceTokenBefore)){e.n=8;break}return e.n=4,gr(u,t,D);case 4:if(!(l=e.v)){e.n=8;break}return l.load("text"),e.n=5,u.sync();case 5:if(f=l.text||"",!((d=f.indexOf(","))>=0)){e.n=6;break}return F=f.slice(0,d)+f.slice(d+1),l.insertText(F,Word.InsertLocation.replace),e.a(2,!0);case 6:return(h=l.search(",",{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=7,u.sync();case 7:if(!h.items.length){e.n=8;break}return h.items[0].insertText("",Word.InsertLocation.replace),e.a(2,!0);case 8:return e.a(2,!1)}},e)}))).apply(this,arguments)}function Fr(e,u,t){return hr.apply(this,arguments)}function hr(){return hr=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c,D,l,f;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=null==n?void 0:n.metadata,o=sn(null==n?void 0:n.paragraphIndex),a=function(){var e=mt(lt().m(function e(u){var t;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(u){e.n=1;break}return e.a(2,!1);case 1:return e.p=1,u.insertText("",Word.InsertLocation.replace),e.a(2,!0);case 2:return e.p=2,t=e.v,wt("apply delete: highlight span removal failed",t),e.a(2,!1)}},e,null,[[1,2]])}));return function(u){return e.apply(this,arguments)}}(),null==n||!n.highlightRange){e.n=2;break}return e.n=1,a(n.highlightRange);case 1:if(!e.v){e.n=2;break}return e.a(2,!0);case 2:i=kn(r),s=0;case 3:if(!(s<i.length)){e.n=11;break}if(c=i[s],Number.isFinite(c.start)&&!(c.start<0)){e.n=4;break}return e.a(3,10);case 4:return D=Number.isFinite(c.end)&&c.end>c.start?c.end:c.start+1,l=null,e.p=5,e.n=6,vn(u,t,o,c.start,D,"apply-delete-highlight-".concat(s),c.snippet);case 6:l=e.v,e.n=8;break;case 7:return e.p=7,f=e.v,wt("apply delete: candidate span lookup failed",f),e.a(3,10);case 8:return e.n=9,a(l);case 9:if(!e.v){e.n=10;break}return e.a(2,!0);case 10:s++,e.n=3;break;case 11:return e.a(2,!1)}},e,null,[[5,7]])})),hr.apply(this,arguments)}function pr(e,u,t){return Er.apply(this,arguments)}function Er(){return(Er=mt(lt().m(function e(u,t,n){var r,o,a;return lt().w(function(e){for(;;)switch(e.n){case 0:if(!((r=rr(t.text||"",n.originalPos))<=0)){e.n=1;break}return wt("apply delete: no ordinal"),e.a(2,!1);case 1:return(o=t.getRange().search(",",{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=2,u.sync();case 2:if(a=r-1,o.items.length&&!(a>=o.items.length)){e.n=3;break}return wt("apply delete: ordinal out of range"),e.a(2,!1);case 3:return o.items[a].insertText("",Word.InsertLocation.replace),e.a(2,!0)}},e)}))).apply(this,arguments)}function Ar(e,u,t){return Cr.apply(this,arguments)}function Cr(){return(Cr=mt(lt().m(function e(u,t,n){return lt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Fr(u,t,n);case 1:if(!e.v){e.n=2;break}return e.a(2,!0);case 2:return e.n=3,fr(u,t,n);case 3:if(!e.v){e.n=4;break}return e.a(2,!0);case 4:return e.n=5,pr(u,t,n);case 5:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function gr(e,u,t){return vr.apply(this,arguments)}function vr(){return vr=mt(lt().m(function e(u,t,n){var r,o,a,i;return lt().w(function(e){for(;;)switch(e.n){case 0:if(null!=n&&n.tokenText){e.n=1;break}return e.a(2,null);case 1:return r="number"==typeof n.textOccurrence?n.textOccurrence:"number"==typeof n.tokenIndex?n.tokenIndex:0,o=function(){var e=mt(lt().m(function e(o,a){var i,s,c;return lt().w(function(e){for(;;)switch(e.n){case 0:if(o){e.n=1;break}return e.a(2,null);case 1:return(i=t.getRange().search(o,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=2,u.sync();case 2:if(i.items.length){e.n=3;break}return e.a(2,null);case 3:return s="number"==typeof a?a:"number"==typeof n.tokenIndex?n.tokenIndex:r,c=Math.max(0,Math.min(s,i.items.length-1)),e.a(2,i.items[c])}},e)}));return function(u,t){return e.apply(this,arguments)}}(),e.n=2,o(n.tokenText,n.textOccurrence);case 2:if(!(a=e.v)){e.n=3;break}return e.a(2,a);case 3:if(!(i=n.tokenText.trim())||i===n.tokenText){e.n=5;break}return e.n=4,o(i,n.trimmedTextOccurrence);case 4:if(!(a=e.v)){e.n=5;break}return e.a(2,a);case 5:return e.a(2,null)}},e)})),vr.apply(this,arguments)}function mr(e){if(!e)return null;var u,t=Et([e.sourceTokenAfter?{anchor:e.sourceTokenAfter,location:Word.InsertLocation.before}:null,e.sourceTokenAt?{anchor:e.sourceTokenAt,location:Word.InsertLocation.after}:null,e.sourceTokenBefore?{anchor:e.sourceTokenBefore,location:Word.InsertLocation.after}:null,e.targetTokenBefore?{anchor:e.targetTokenBefore,location:Word.InsertLocation.before}:null,e.targetTokenAt?{anchor:e.targetTokenAt,location:Word.InsertLocation.after}:null].filter(Boolean));try{for(t.s();!(u=t.n()).done;){var n,r=u.value;if(null!=r&&null!==(n=r.anchor)&&void 0!==n&&n.matched&&Number.isFinite(r.anchor.charStart)&&r.anchor.charStart>=0)return r}}catch(e){t.e(e)}finally{t.f()}return null}function yr(e,u,t){return Br.apply(this,arguments)}function Br(){return(Br=mt(lt().m(function e(u,t,n){var r,o,a,i,s;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=null==n?void 0:n.metadata){e.n=1;break}return e.a(2,!1);case 1:if(o=mr(r)){e.n=2;break}return e.a(2,!1);case 2:return a=sn(n.paragraphIndex),e.n=3,vn(u,t,a,o.anchor.charStart,o.anchor.charEnd,"apply-insert-anchor",o.anchor.tokenText||r.highlightText);case 3:if(i=e.v){e.n=4;break}return e.a(2,!1);case 4:e.p=4,o.location===Word.InsertLocation.before?i.insertText(",",Word.InsertLocation.before):i.getRange("After").insertText(",",Word.InsertLocation.before),e.n=6;break;case 5:return e.p=5,s=e.v,wt("apply insert metadata: failed to insert via anchor",s),e.a(2,!1);case 6:return e.a(2,!0)}},e,null,[[4,5]])}))).apply(this,arguments)}function br(e,u,t){return wr.apply(this,arguments)}function wr(){return wr=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c,D,l,f,d;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=null==n?void 0:n.metadata,a=sn(null==n?void 0:n.paragraphIndex),null!==(r=null==a?void 0:a.originalText)&&void 0!==r?r:null==t?void 0:t.text,i=function(){var e=mt(lt().m(function e(u){var t;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(u){e.n=1;break}return e.a(2,!1);case 1:return e.p=1,u.getRange("After").insertText(",",Word.InsertLocation.before),e.a(2,!0);case 2:return e.p=2,t=e.v,wt("apply insert highlight: failed to reuse range",t),e.a(2,!1)}},e,null,[[1,2]])}));return function(u){return e.apply(this,arguments)}}(),null==n||!n.highlightRange){e.n=2;break}return e.n=1,i(n.highlightRange);case 1:if(!e.v){e.n=2;break}return e.a(2,!0);case 2:s=xn(o),c=0;case 3:if(!(c<s.length)){e.n=11;break}if(D=s[c],Number.isFinite(D.start)&&!(D.start<0)){e.n=4;break}return e.a(3,10);case 4:return l=Number.isFinite(D.end)&&D.end>D.start?D.end:D.start+1,f=null,e.p=5,e.n=6,vn(u,t,a,D.start,l,"apply-insert-highlight-".concat(c),D.snippet);case 6:f=e.v,e.n=8;break;case 7:return e.p=7,d=e.v,wt("apply insert: candidate span lookup failed",d),e.a(3,10);case 8:return e.n=9,i(f);case 9:if(!e.v){e.n=10;break}return e.a(2,!0);case 10:c++,e.n=3;break;case 11:return e.a(2,!1)}},e,null,[[5,7]])})),wr.apply(this,arguments)}function kr(e,u,t){return xr.apply(this,arguments)}function xr(){return(xr=mt(lt().m(function e(u,t,n){var r;return lt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Pr(u,t,n);case 1:if(r=e.v){e.n=2;break}return wt("apply insert: unable to locate range"),e.a(2,!1);case 2:return r.getRange("After").insertText(",",Word.InsertLocation.before),e.a(2,!0)}},e)}))).apply(this,arguments)}function Tr(e,u,t){return Or.apply(this,arguments)}function Or(){return(Or=mt(lt().m(function e(u,t,n){return lt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,br(u,t,n);case 1:if(!e.v){e.n=2;break}return e.a(2,!0);case 2:return e.n=3,yr(u,t,n);case 3:if(!e.v){e.n=4;break}return e.a(2,!0);case 4:return e.n=5,kr(u,t,n);case 5:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function Sr(e,u){return _r.apply(this,arguments)}function _r(){return(_r=mt(lt().m(function e(u,t){var n,r,o,a,i,s;return lt().w(function(e){for(;;)switch(e.n){case 0:return t.load("text"),e.n=1,u.sync();case 1:if((n=t.text||"").includes(",")){e.n=2;break}return e.a(2);case 2:r=n.length-1;case 3:if(!(r>=0)){e.n=10;break}if(","===n[r]){e.n=4;break}return e.a(3,9);case 4:if(!(r>0&&/\s/.test(n[r-1]))){e.n=6;break}return e.n=5,Cn(u,t,n,r-1,r,"trim-space-before-comma"," ");case 5:(a=e.v)&&a.insertText("",Word.InsertLocation.replace);case 6:if(i=null!==(o=n[r+1])&&void 0!==o?o:""){e.n=7;break}return e.a(3,9);case 7:if(/\s/.test(i)||Sn.has(i)||_n(i)){e.n=9;break}return e.n=8,Cn(u,t,n,r+1,r+2,"space-after-comma",i);case 8:(s=e.v)&&s.insertText(" ",Word.InsertLocation.before);case 9:r--,e.n=3;break;case 10:return e.a(2)}},e)}))).apply(this,arguments)}function Rr(e,u,t){return jr.apply(this,arguments)}function jr(){return(jr=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null!=n&&n.size){e.n=1;break}return e.a(2);case 1:r=Et(n),e.p=2,r.s();case 3:if((o=r.n()).done){e.n=8;break}if(a=o.value,i=t.items[a]){e.n=4;break}return e.a(3,7);case 4:return e.p=4,e.n=5,Sr(u,i);case 5:e.n=7;break;case 6:e.p=6,s=e.v,wt("Failed to normalize comma spacing",s);case 7:e.n=3;break;case 8:e.n=10;break;case 9:e.p=9,c=e.v,r.e(c);case 10:return e.p=10,r.f(),e.f(10);case 11:return e.a(2)}},e,null,[[4,6],[2,9,10,11]])}))).apply(this,arguments)}function Pr(e,u,t){return Ir.apply(this,arguments)}function Ir(){return(Ir=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c,D;return lt().w(function(e){for(;;)switch(e.n){case 0:if(r={matchCase:!1,matchWholeWord:!1},o=null,!n.leftWord){e.n=2;break}return(a=t.getRange().search(n.leftWord,{matchCase:!1,matchWholeWord:!0})).load("items"),e.n=1,u.sync();case 1:a.items.length&&(o=a.items[a.items.length-1]);case 2:if(i=(n.leftSnippet||"").slice(-20).replace(/[\r\n]+/g," "),o||!i.trim()){e.n=4;break}return(s=t.getRange().search(i.trim(),r)).load("items"),e.n=3,u.sync();case 3:s.items.length&&(o=s.items[s.items.length-1]);case 4:if(o){e.n=6;break}if(!(c=(c=(n.rightSnippet||"").replace(/,/g,"").trim()).slice(0,8))){e.n=6;break}return(D=t.getRange().search(c,r)).load("items"),e.n=5,u.sync();case 5:D.items.length&&(o=D.items[0]);case 6:return e.a(2,o)}},e)}))).apply(this,arguments)}function Nr(e,u,t){return Lr.apply(this,arguments)}function Lr(){return(Lr=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c;return lt().w(function(e){for(;;)switch(e.n){case 0:if(n){e.n=1;break}return e.a(2);case 1:if(!n.highlightRange){e.n=2;break}try{n.highlightRange.font.highlightColor=null,u.trackedObjects.remove(n.highlightRange)}catch(e){wt("clearHighlightForSuggestion: failed via highlightRange",e)}finally{n.highlightRange=null}return e.a(2);case 2:if(o=n.metadata){e.n=3;break}return e.a(2);case 3:if(a=on[n.paragraphIndex],i="number"==typeof o.highlightCharStart?o.highlightCharStart:o.charStart,s="number"==typeof o.highlightCharEnd?o.highlightCharEnd:o.charEnd,t&&Number.isFinite(i)){e.n=4;break}return e.a(2);case 4:return e.n=5,vn(u,t,a,i,s,"clear-highlight",o.highlightText||(null===(r=o.highlightAnchorTarget)||void 0===r?void 0:r.tokenText));case 5:(c=e.v)&&(c.font.highlightColor=null);case 6:return e.a(2)}},e)}))).apply(this,arguments)}function Ur(e,u,t){return Wr.apply(this,arguments)}function Wr(){return(Wr=mt(lt().m(function e(u,t,n){var r,o,a,i,s,c,D,l,f,d,F,h;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=Array.isArray(t),a=function(e){if(null!=e&&e.highlightRange)try{e.highlightRange.font.highlightColor=null,u.trackedObjects.remove(e.highlightRange)}catch(e){wt("Failed to clear highlight",e)}finally{e.highlightRange=null}},(o=r?t:Nt).length){e.n=2;break}if(r){e.n=1;break}return u.document.body.font.highlightColor=null,e.n=1,u.sync();case 1:return e.a(2);case 2:i=Et(o),e.p=3,i.s();case 4:if((s=i.n()).done){e.n=9;break}if(f=s.value,d=null!==(c=null==f?void 0:f.suggestion)&&void 0!==c?c:f){e.n=5;break}return e.a(3,8);case 5:if(!(F=null!==(D=null==f?void 0:f.paragraph)&&void 0!==D?D:null==n||null===(l=n.items)||void 0===l?void 0:l[d.paragraphIndex])){e.n=7;break}return e.n=6,Nr(u,F,d);case 6:e.n=8;break;case 7:a(d);case 8:e.n=4;break;case 9:e.n=11;break;case 10:e.p=10,h=e.v,i.e(h);case 11:return e.p=11,i.f(),e.f(11);case 12:return e.n=13,u.sync();case 13:t||Mt();case 14:return e.a(2)}},e,null,[[3,10,11,12]])}))).apply(this,arguments)}function Mr(){return zr.apply(this,arguments)}function zr(){return zr=mt(lt().m(function e(){return lt().w(function(e){for(;;)switch(e.n){case 0:if(Nt.length){e.n=1;break}return e.a(2);case 1:return e.n=2,Word.run(function(){var e=mt(lt().m(function e(u){var t,n,r,o,a,i,s,c,D,l,f,d,F,h,p;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:return(t=u.document.body.paragraphs).load("items/text"),e.n=1,u.sync();case 1:n=t.items.map(function(e){var u;return null!==(u=null==e?void 0:e.text)&&void 0!==u?u:""}),r=new Set(Vt),o=[],a=[],i=function(e){var u,t,n,r;return e?Number.isFinite(e.originalPos)?e.originalPos:Number.isFinite(null===(u=e.metadata)||void 0===u?void 0:u.originalPos)?e.metadata.originalPos:Number.isFinite(null===(t=e.metadata)||void 0===t?void 0:t.charStart)?e.metadata.charStart:Number.isFinite(null===(n=e.metadata)||void 0===n?void 0:n.targetCharStart)?e.metadata.targetCharStart:Number.isFinite(null===(r=e.metadata)||void 0===r?void 0:r.highlightCharStart)?e.metadata.highlightCharStart:-1:-1},s=Nt.slice().sort(function(e,u){var t,n,r,o,a,s;return(null!==(t=null==e?void 0:e.paragraphIndex)&&void 0!==t?t:0)!==(null!==(n=null==u?void 0:u.paragraphIndex)&&void 0!==n?n:0)?(null!==(a=null==e?void 0:e.paragraphIndex)&&void 0!==a?a:0)-(null!==(s=null==u?void 0:u.paragraphIndex)&&void 0!==s?s:0):(null!==(r=i(u))&&void 0!==r?r:-1)-(null!==(o=i(e))&&void 0!==o?o:-1)}),c=Et(s),e.p=2,c.s();case 3:if((D=c.n()).done){e.n=14;break}if(l=D.value,f=t.items[l.paragraphIndex]){e.n=4;break}return e.a(3,13);case 4:if(e.p=4,"delete"!==l.kind){e.n=6;break}return e.n=5,Ar(u,f,l);case 5:F=e.v,e.n=8;break;case 6:return e.n=7,Tr(u,f,l);case 7:F=e.v;case 8:if(F){e.n=9;break}return a.push(l),e.a(3,13);case 9:return f.load("text"),e.n=10,u.sync();case 10:if((d=f.text||"")!==n[l.paragraphIndex]){e.n=11;break}return a.push(l),e.a(3,13);case 11:n[l.paragraphIndex]=d,o.push({suggestion:l,paragraph:f}),e.n=13;break;case 12:e.p=12,h=e.v,wt("applyAllSuggestionsOnline: failed to apply suggestion",h),a.push(l);case 13:e.n=3;break;case 14:e.n=16;break;case 15:e.p=15,p=e.v,c.e(p);case 16:return e.p=16,c.f(),e.f(16);case 17:return e.n=18,u.sync();case 18:return e.n=19,Ur(u,o);case 19:return e.n=20,Rr(u,t,r);case 20:return Kt(),an(),Mt(),a.length?Nt.push.apply(Nt,a):u.document.body.font.highlightColor=null,e.n=21,u.sync();case 21:return e.a(2)}},e,null,[[4,12],[2,15,16,17]])}));return function(u){return e.apply(this,arguments)}}());case 2:return e.a(2)}},e)})),zr.apply(this,arguments)}function qr(){return Vr.apply(this,arguments)}function Vr(){return Vr=mt(lt().m(function e(){return lt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=mt(lt().m(function e(u){var t;return lt().w(function(e){for(;;)switch(e.n){case 0:return(t=u.document.body.paragraphs).load("items/text"),e.n=1,u.sync();case 1:return e.n=2,Ur(u,null,t);case 2:return u.document.body.font.highlightColor=null,e.n=3,u.sync();case 3:return e.a(2)}},e)}));return function(u){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),Vr.apply(this,arguments)}function Kr(){return Gr.apply(this,arguments)}function Gr(){return(Gr=mt(lt().m(function e(){return lt().w(function(e){for(;;)switch(e.n){case 0:if(tn(),!st()){e.n=1;break}return e.a(2,$r());case 1:return e.a(2,Jr())}},e)}))).apply(this,arguments)}function Jr(){return Hr.apply(this,arguments)}function Hr(){return Hr=mt(lt().m(function e(){var u,t,n,r,o;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:return bt("START checkDocumentText()"),u=0,t=0,n=0,r=0,e.p=1,e.n=2,Word.run(function(){var e=mt(lt().m(function e(o){var a,i,s,c,D,l,f,d,F,h,p,E,A,C,g,v,m,y,B,b,w;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,nn(o);case 1:if(!e.v){e.n=2;break}return Qt(),e.a(2);case 2:return a=o.document,i=!1,s=!1,e.p=3,a.load("trackRevisions"),e.n=4,o.sync();case 4:s=a.trackRevisions,a.trackRevisions=!0,i=!0,bt("TrackRevisions:",s,"-> true"),e.n=6;break;case 5:e.p=5,B=e.v,wt("trackRevisions not available -> skip toggling",B);case 6:return e.p=6,(c=o.document.body.paragraphs).load("items/text"),e.n=7,o.sync();case 7:bt("Paragraphs found:",c.items.length),D=0;case 8:if(!(D<c.items.length)){e.n=34;break}if(l=c.items[D],f=l.text||"",d=f.trim()){e.n=9;break}return e.a(3,33);case 9:if(!(d.length>Lt)){e.n=10;break}return $t(D,d.length),e.a(3,33);case 10:F=xt(),n++,bt("P".concat(D,": len=").concat(f.length,' | "').concat(Tt(d),'"')),h=f,p=0;case 11:if(!(p<Ot)){e.n=32;break}return E=void 0,e.p=12,e.n=13,nt(h);case 13:E=e.v,e.n=15;break;case 14:return e.p=14,b=e.v,r++,wt("P".concat(D," pass ").concat(p,": API call failed -> stop paragraph"),b),un(),e.a(3,32);case 15:if(bt("P".concat(D," pass ").concat(p,': corrected -> "').concat(Tt(E),'"')),A=qn(h,E),C=Vn(h,E,A),bt("P".concat(D," pass ").concat(p,": ops candidate=").concat(A.length,", after filter=").concat(C.length)),C.length){e.n=16;break}return 0===p&&bt("P".concat(D,": no applicable comma ops")),e.a(3,32);case 16:g=Et(C),e.p=17,g.s();case 18:if((v=g.n()).done){e.n=24;break}if("insert"!==(m=v.value).kind){e.n=21;break}return e.n=19,$n(o,l,h,E,m.pos);case 19:return e.n=20,Zn(o,l,E,m.pos);case 20:u++,e.n=23;break;case 21:return e.n=22,Qn(o,l,h,m.pos);case 22:t++;case 23:e.n=18;break;case 24:e.n=26;break;case 25:e.p=25,w=e.v,g.e(w);case 26:return e.p=26,g.f(),e.f(26);case 27:return e.n=28,o.sync();case 28:return l.load("text"),e.n=29,o.sync();case 29:if((y=l.text||"")&&y!==h){e.n=30;break}return e.a(3,32);case 30:h=y;case 31:p++,e.n=11;break;case 32:bt("P".concat(D,": applied (ins=").concat(u,", del=").concat(t,") | ").concat(Math.round(xt()-F)," ms"));case 33:D++,e.n=8;break;case 34:if(e.p=34,!i){e.n=36;break}return a.trackRevisions=s,e.n=35,o.sync();case 35:bt("TrackRevisions restored ->",s);case 36:return e.f(34);case 37:return e.a(2)}},e,null,[[17,25,26,27],[12,14],[6,,34,37],[3,5]])}));return function(u){return e.apply(this,arguments)}}());case 2:bt("DONE checkDocumentText() | paragraphs:",n,"| inserted:",u,"| deleted:",t,"| apiErrors:",r),e.n=4;break;case 3:e.p=3,o=e.v,kt("ERROR in checkDocumentText:",o);case 4:return e.a(2)}},e,null,[[1,3]])})),Hr.apply(this,arguments)}function $r(){return Xr.apply(this,arguments)}function Xr(){return Xr=mt(lt().m(function e(){var u,t,n,r;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:return bt("START checkDocumentTextOnline()"),u=0,t=0,n=0,e.p=1,e.n=2,Word.run(function(){var e=mt(lt().m(function e(r){var o,a,i,s,c,D,l,f,d;return lt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,nn(r);case 1:if(!e.v){e.n=2;break}return Qt(),e.a(2);case 2:return(o=r.document.body.paragraphs).load("items/text"),e.n=3,r.sync();case 3:return e.n=4,Ur(r,null,o);case 4:Mt(),Kt(),an(),a=0,i=0;case 5:if(!(i<o.items.length)){e.n=9;break}if(s=o.items[i],c=s.text||"",D=Pt(c),l=D.trim(),f=a,a+=c.length+1,l){e.n=6;break}return cn({paragraphIndex:i,originalText:c,correctedText:c,sourceTokens:[],targetTokens:[],documentOffset:f}),e.a(3,8);case 6:return bt("P".concat(i," ONLINE: len=").concat(c.length,' | "').concat(Tt(l),'"')),u++,e.n=7,no({context:r,paragraph:s,paragraphIndex:i,originalText:c,normalizedOriginalText:D,paragraphDocOffset:f});case 7:d=e.v,t+=d.suggestionsAdded,n+=d.apiErrors;case 8:i++,e.n=5;break;case 9:return e.n=10,r.sync();case 10:return e.a(2)}},e)}));return function(u){return e.apply(this,arguments)}}());case 2:bt("DONE checkDocumentTextOnline() | paragraphs:",u,"| suggestions:",t,"| apiErrors:",n),e.n=4;break;case 3:e.p=3,r=e.v,kt("ERROR in checkDocumentTextOnline:",r);case 4:return e.a(2)}},e,null,[[1,3]])})),Xr.apply(this,arguments)}function Zr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lt,t="string"==typeof e?e:"";if(!t)return[];for(var n=t,r=[],o=0,a=function(e){var u,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;"number"!=typeof e||e<=o?o=Math.max(o,null!==(u=null!=t?t:e)&&void 0!==u?u:o):(r.push({start:o,end:e,gapEnd:null!=t?t:e}),o=null!=t?t:e)},i=0;i<n.length;i++){var s=n[i];if("\n"!==s){if(/[.!?]/.test(s)){for(var c=i+1;c<n.length&&/[\])"'»”’]+/.test(n[c]);)c++;for(var D=c;D<n.length&&/\s/.test(n[D]);)D++;a(c,D),i=D-1}}else a(i+1,i+1)}return o<n.length&&r.push({start:o,end:n.length,gapEnd:n.length}),r.map(function(e,n){var r,o=null!==(r=e.gapEnd)&&void 0!==r?r:e.end,a=e.end-e.start;return{index:n,start:e.start,end:e.end,length:a,text:t.slice(e.start,e.end).replace(new RegExp("","g"),"."),trailing:t.slice(e.end,o),tooLong:a>u}})}function Yr(e,u){if(!Array.isArray(e))return{tokens:[],map:new Map};var t=new Map,n=e.map(function(e,n){if(e&&"object"===gt(e)){var r=Ft(Ft({},e),{},{token_id:"".concat(u).concat(n+1)});return"string"==typeof e.token_id&&t.set(e.token_id,r.token_id),r}return{token_id:"".concat(u).concat(n+1),token:"string"==typeof e?e:""}});return{tokens:n,map:t}}function Qr(e,u){return Yr(e,u)}function eo(e,u){if(!e||null==u||!u.size)return e;var t=function(e){var t;if(!e)return e;var n=Ft({},e),r=null!==(t=u.get(e.source_start))&&void 0!==t?t:e.source_start;return n.source_start=r,Array.isArray(e.corrections)&&(n.corrections=e.corrections.map(function(e){var t;if(!e)return e;var n=null!==(t=u.get(e.source_id))&&void 0!==t?t:e.source_id;return Ft(Ft({},e),{},{source_id:n})})),n};if(Array.isArray(e))return e.map(t);if("object"===gt(e)){for(var n={},r=0,o=Object.entries(e);r<o.length;r++){var a=pt(o[r],2),i=a[0],s=a[1];n[i]=t(s)}return n}return e}function uo(e){return!!e&&(Array.isArray(e)?e.some(function(e){return Array.isArray(null==e?void 0:e.corrections)&&e.corrections.length}):"object"===gt(e)&&Object.values(e).some(function(e){return Array.isArray(null==e?void 0:e.corrections)&&e.corrections.length}))}function to(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"syn";if("string"!=typeof e||!e.length)return[];for(var t,n=[],r=/[^\s]+/g,o=1;t=r.exec(e);)n.push({token_id:"".concat(u).concat(o++),token:t[0],start_char:t.index,end_char:t.index+t[0].length});return n}function no(e){return ro.apply(this,arguments)}function ro(){return(ro=mt(lt().m(function e(u){var t,n,r,o,a,i,s,c,D,l,f,d,F,h,p,E,A,C,g,v,m,y,B,b,w,k,x,T,O,S,_,R,j,P,I,N,L,U,W,M,z,q,V,K,G,J,H,$,X;return lt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=u.context,n=u.paragraph,r=u.paragraphIndex,o=u.originalText,a=u.normalizedOriginalText,i=u.paragraphDocOffset,(s=Zr(o,Lt)).length){e.n=1;break}return e.a(2,{suggestionsAdded:0,apiErrors:0,processedAny:!1});case 1:c="string"==typeof a?a:Pt(o),s.forEach(function(e){e.normalizedText=c.slice(e.start,e.end)}),D=[],l=[],f=0,d=0,F=Et(s),e.p=2,F.s();case 3:if((h=F.n()).done){e.n=12;break}if(E=h.value,A={chunk:E,correctedText:E.normalizedText,detail:null,syntheticTokens:null},l.push(A),!E.tooLong){e.n=4;break}return Xt(r,E.length),A.syntheticTokens=to(E.text,"p".concat(r,"_c").concat(E.index,"_syn_")),e.a(3,11);case 4:return C=null,e.p=5,e.n=6,ot(E.normalizedText||E.text);case 6:C=e.v,"undefined"!=typeof window&&(window.__LAST_DETAIL__=C),e.n=8;break;case 7:return e.p=7,J=e.v,d++,wt("P".concat(r," chunk ").concat(E.index,": API call failed"),J),Zt(r,E.index),A.syntheticTokens=to(E.text,"p".concat(r,"_c").concat(E.index,"_syn_")),e.a(3,11);case 8:if(g=C.correctedText,Pn(E.normalizedText||E.text,g)){e.n=9;break}return Yt(r,E.index,E.text,g),bt("P".concat(r," chunk ").concat(E.index,": API changed more than commas -> SKIP"),{original:E.text,corrected:g}),A.syntheticTokens=to(E.text,"p".concat(r,"_c").concat(E.index,"_syn_")),e.a(3,11);case 9:if(A.detail=C,A.correctedText=g,v=E.text||E.normalizedText||"",m=uo(null===(p=C)||void 0===p?void 0:p.corrections)?[]:Kn(Vn(v,g,qn(v,g))),A.detail||m.length){e.n=10;break}return e.a(3,11);case 10:D.push({chunk:E,metaRef:A,baseForDiff:v,correctedChunk:g,diffOps:m});case 11:e.n=3;break;case 12:e.n=14;break;case 13:e.p=13,H=e.v,F.e(H);case 14:return e.p=14,F.f(),e.f(14);case 15:if(l.some(function(e){return e.detail})){e.n=16;break}return e.a(2,{suggestionsAdded:0,apiErrors:d,processedAny:!1});case 16:y=l.map(function(e){var u;return e.correctedText+(null!==(u=e.chunk.trailing)&&void 0!==u?u:"")}).join(""),B=[],b=[],l.forEach(function(e){var u="p".concat(r,"_c").concat(e.chunk.index,"_");if(e.detail){var t=Qr(e.detail.sourceTokens,"".concat(u,"s")),n=t.tokens,o=t.map;B.push.apply(B,Dt(n));var a=Qr(e.detail.targetTokens,"".concat(u,"t")).tokens;b.push.apply(b,Dt(a)),e.remappedCorrections=eo(e.detail.corrections,o)}else if(e.syntheticTokens&&e.syntheticTokens.length){var i=Yr(e.syntheticTokens,"".concat(u,"syn_")).tokens;B.push.apply(B,Dt(i)),b.push.apply(b,Dt(i))}}),w=cn({paragraphIndex:r,originalText:o,correctedText:y,sourceTokens:B,targetTokens:b,documentOffset:i}),k=0,x=D;case 17:if(!(k<x.length)){e.n=36;break}if(S=x[k],_=null!==(T=S.metaRef)&&void 0!==T&&T.detail?Ft(Ft({},S.metaRef.detail),{},{corrections:null!==(O=S.metaRef.remappedCorrections)&&void 0!==O?O:S.metaRef.detail.corrections}):null,R=[],j=null!=_&&_.corrections?Un():null,(P=uo(null==_?void 0:_.corrections))&&(R=Mn(_,w,r,j)),(I=S.diffOps||[]).length&&(P&&!R.length||(I=Gn(I,j)),P||!_||R.length?!R.length&&P&&(I=I.map(function(e){return Ft(Ft({},e),{},{fromCorrections:!0})})):(R=I.map(function(e){return Ft(Ft({},e),{},{fromCorrections:!0,viaDiffFallback:!0})}),I=[])),N=!R.length,(L=N?I:R).length){e.n=18;break}return e.a(3,35);case 18:U=Et(L),e.p=19,M=lt().m(function e(){var u,a,i,s,c;return lt().w(function(e){for(;;)switch(e.n){case 0:if(u=W.value,R.includes(u)||"insert"!==u.kind){e.n=1;break}if(!R.some(function(e){return"insert"===e.kind&&e.pos===u.pos})){e.n=1;break}return e.a(2,0);case 1:if(a=R.includes(u)?u:null,i=S.chunk.start,c=Ft(Ft({},s=a||u),{},{pos:s.pos+i,originalPos:("number"==typeof s.originalPos?s.originalPos:s.pos)+i,correctedPos:("number"==typeof s.correctedPos?s.correctedPos:s.pos)+i}),!a){e.n=3;break}return e.n=2,tr(t,n,o,y,c,r,w);case 2:e.v&&f++,e.n=6;break;case 3:if(!Jn(w,c)){e.n=4;break}return e.a(2,0);case 4:return e.n=5,tr(t,n,o,y,c,r,w);case 5:e.v&&f++;case 6:return e.a(2)}},e)}),U.s();case 20:if((W=U.n()).done){e.n=23;break}return e.d(ct(M()),21);case 21:if(0!==e.v){e.n=22;break}return e.a(3,22);case 22:e.n=20;break;case 23:e.n=25;break;case 24:e.p=24,$=e.v,U.e($);case 25:return e.p=25,U.f(),e.f(25);case 26:if(R.length||!I.length){e.n=35;break}z=Et(I),e.p=27,z.s();case 28:if((q=z.n()).done){e.n=32;break}if(V=q.value,K=S.chunk.start,G=Ft(Ft({},V),{},{pos:V.pos+K,originalPos:("number"==typeof V.originalPos?V.originalPos:V.pos)+K,correctedPos:("number"==typeof V.correctedPos?V.correctedPos:V.pos)+K}),!Jn(w,G)){e.n=29;break}return e.a(3,31);case 29:return e.n=30,tr(t,n,o,y,G,r,w);case 30:e.v&&f++;case 31:e.n=28;break;case 32:e.n=34;break;case 33:e.p=33,X=e.v,z.e(X);case 34:return e.p=34,z.f(),e.f(34);case 35:k++,e.n=17;break;case 36:return e.a(2,{suggestionsAdded:f,apiErrors:d,processedAny:!0})}},e,null,[[27,33,34,35],[19,24,25,26],[5,7],[2,13,14,15]])}))).apply(this,arguments)}function oo(){var e,u,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function o(t,n,r,o){var s=n&&n.prototype instanceof i?n:i,c=Object.create(s.prototype);return ao(c,"_invoke",function(t,n,r){var o,i,s,c=0,D=r||[],l=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(u,t){return o=u,i=0,s=e,f.n=t,a}};function d(t,n){for(i=t,s=n,u=0;!l&&c&&!r&&u<D.length;u++){var r,o=D[u],d=f.p,F=o[2];t>3?(r=F===n)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=d&&((r=t<2&&d<o[1])?(i=0,f.v=n,f.n=o[1]):d<F&&(r=t<3||o[0]>n||n>F)&&(o[4]=t,o[5]=n,f.n=F,i=0))}if(r||t>1)return a;throw l=!0,n}return function(r,D,F){if(c>1)throw TypeError("Generator is already running");for(l&&1===D&&d(D,F),i=D,s=F;(u=i<2?e:s)||!l;){o||(i?i<3?(i>1&&(f.n=-1),d(i,s)):f.n=s:f.v=s);try{if(c=2,o){if(i||(r="next"),u=o[r]){if(!(u=u.call(o,s)))throw TypeError("iterator result is not an object");if(!u.done)return u;s=u.value,i<2&&(i=0)}else 1===i&&(u=o.return)&&u.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((u=(l=f.n<0)?s:t.call(n,f))!==a)break}catch(u){o=e,i=1,s=u}finally{c=1}}return{value:u,done:l}}}(t,r,o),!0),c}var a={};function i(){}function s(){}function c(){}u=Object.getPrototypeOf;var D=[][n]?u(u([][n]())):(ao(u={},n,function(){return this}),u),l=c.prototype=i.prototype=Object.create(D);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ao(e,r,"GeneratorFunction")),e.prototype=Object.create(l),e}return s.prototype=c,ao(l,"constructor",c),ao(c,"constructor",s),s.displayName="GeneratorFunction",ao(c,r,"GeneratorFunction"),ao(l),ao(l,r,"Generator"),ao(l,n,function(){return this}),ao(l,"toString",function(){return"[object Generator]"}),(oo=function(){return{w:o,m:f}})()}function ao(e,u,t,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ao=function(e,u,t,n){function o(u,t){ao(e,u,function(e){return this._invoke(u,t,e)})}u?r?r(e,u,{value:t,enumerable:!n,configurable:!n,writable:!n}):e[u]=t:(o("next",0),o("throw",1),o("return",2))},ao(e,u,t,n)}function io(e,u,t,n,r,o,a){try{var i=e[o](a),s=i.value}catch(e){return void t(e)}i.done?u(s):Promise.resolve(s).then(n,r)}function so(e){return function(){var u=this,t=arguments;return new Promise(function(n,r){var o=e.apply(u,t);function a(e){io(o,n,r,a,i,"next",e)}function i(e){io(o,n,r,a,i,"throw",e)}a(void 0)})}}var co,Do="undefined"!=typeof window&&"boolean"==typeof window.__VEJICE_DEBUG__?window.__VEJICE_DEBUG__:void 0,lo="boolean"==typeof Do?Do:!function(){var e;return"undefined"!=typeof process&&"production"===(null===(e=process.env)||void 0===e?void 0:"production")||"undefined"!=typeof window&&"production"===window.__VEJICE_ENV__}(),fo=function(){for(var e,u=arguments.length,t=new Array(u),n=0;n<u;n++)t[n]=arguments[n];return lo&&(e=console).log.apply(e,["[Vejice CMD]"].concat(t))},Fo=function(){for(var e,u=arguments.length,t=new Array(u),n=0;n<u;n++)t[n]=arguments[n];return(e=console).error.apply(e,["[Vejice CMD]"].concat(t))},ho=function(){var e,u,t;return null!==(e=null===(u=performance)||void 0===u||null===(t=u.now)||void 0===t?void 0:t.call(u))&&void 0!==e?e:Date.now()},po=function(e,u){try{e&&e.completed&&e.completed()}catch(e){Fo("".concat(u,": event.completed() threw"),e)}},Eo=function(){try{var e,u;return Boolean(null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e||null===(e=e.requirements)||void 0===e||null===(u=e.isSetSupported)||void 0===u?void 0:u.call(e,"WordApi","1.3"))}catch(e){return Fo("Failed to check requirement set support",e),!1}},Ao=function(e){if("boolean"==typeof e)return e;if("string"==typeof e){var u=e.trim().toLowerCase();if(!u)return;if(["1","true","yes","on"].includes(u))return!0;if(["0","false","no","off"].includes(u))return!1}};if("undefined"!=typeof window&&"undefined"!=typeof URLSearchParams)try{var Co=new URLSearchParams(window.location.search||"").get("mock");null!==Co&&(co=Ao(Co))}catch(e){Fo("Failed to parse ?mock query param",e)}var go,vo="undefined"!=typeof process?Ao(null!==(Tn=null===(On=process.env)||void 0===On?void 0:"")&&void 0!==Tn?Tn:""):void 0;"boolean"==typeof co?go=co:"boolean"==typeof vo&&(go=vo),"undefined"!=typeof window&&"boolean"==typeof go&&(window.__VEJICE_USE_MOCK__=go,go&&fo("Mock API mode is ENABLED")),Office.onReady(function(){var e,u;fo("Office ready | Host:",null===(e=Office)||void 0===e||null===(e=e.context)||void 0===e?void 0:e.host,"| Platform:",null===(u=Office)||void 0===u?void 0:u.platform)}),window.checkDocumentText=function(){var e=so(oo().m(function e(u){var t,n;return oo().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=ho(),fo("CLICK: Preveri vejice (checkDocumentText)"),e.p=1,e.n=2,Kr();case 2:fo("DONE: checkDocumentText |",Math.round(ho()-t),"ms"),e.n=4;break;case 3:e.p=3,n=e.v,Fo("checkDocumentText failed:",n);case 4:return e.p=4,po(u,"checkDocumentText"),fo("event.completed(): checkDocumentText"),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(u){return e.apply(this,arguments)}}(),window.acceptAllChanges=function(){var e=so(oo().m(function e(u){var t,n,r;return oo().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=ho(),fo("CLICK: Sprejmi spremembe (acceptAllChanges)"),e.p=1,!st()){e.n=3;break}return e.n=2,Mr();case 2:fo("Applied online suggestions |",Math.round(ho()-t),"ms"),e.n=5;break;case 3:if(Eo()){e.n=4;break}throw new Error("Revisions API is not available on this host");case 4:return e.n=5,Word.run(function(){var e=so(oo().m(function e(u){var n,r;return oo().w(function(e){for(;;)switch(e.n){case 0:return(n=u.document.revisions).load("items"),e.n=1,u.sync();case 1:return r=n.items.length,fo("Revisions to accept:",r),n.items.forEach(function(e){return e.accept()}),e.n=2,u.sync();case 2:fo("Accepted revisions:",r,"|",Math.round(ho()-t),"ms");case 3:return e.a(2)}},e)}));return function(u){return e.apply(this,arguments)}}());case 5:e.n=7;break;case 6:e.p=6,null!=(r=e.v)&&null!==(n=r.message)&&void 0!==n&&n.includes("Revisions API is not available")?Fo("acceptAllChanges skipped: revisions API is not available on this host"):Fo("acceptAllChanges failed:",r);case 7:return e.p=7,po(u,"acceptAllChanges"),fo("event.completed(): acceptAllChanges"),e.f(7);case 8:return e.a(2)}},e,null,[[1,6,7,8]])}));return function(u){return e.apply(this,arguments)}}(),window.rejectAllChanges=function(){var e=so(oo().m(function e(u){var t,n,r;return oo().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=ho(),fo("CLICK: Zavrni spremembe (rejectAllChanges)"),e.p=1,!st()){e.n=3;break}return e.n=2,qr();case 2:fo("Cleared online suggestions |",Math.round(ho()-t),"ms"),e.n=5;break;case 3:if(Eo()){e.n=4;break}throw new Error("Revisions API is not available on this host");case 4:return e.n=5,Word.run(function(){var e=so(oo().m(function e(u){var n,r;return oo().w(function(e){for(;;)switch(e.n){case 0:return(n=u.document.revisions).load("items"),e.n=1,u.sync();case 1:return r=n.items.length,fo("Revisions to reject:",r),n.items.forEach(function(e){return e.reject()}),e.n=2,u.sync();case 2:fo("Rejected revisions:",r,"|",Math.round(ho()-t),"ms");case 3:return e.a(2)}},e)}));return function(u){return e.apply(this,arguments)}}());case 5:e.n=7;break;case 6:e.p=6,null!=(r=e.v)&&null!==(n=r.message)&&void 0!==n&&n.includes("Revisions API is not available")?Fo("rejectAllChanges skipped: revisions API is not available on this host"):Fo("rejectAllChanges failed:",r);case 7:return e.p=7,po(u,"rejectAllChanges"),fo("event.completed(): rejectAllChanges"),e.f(7);case 8:return e.a(2)}},e,null,[[1,6,7,8]])}));return function(u){return e.apply(this,arguments)}}()}();
//# sourceMappingURL=commands.js.map